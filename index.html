<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>sakuin-tool</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="./kuromoji.js"></script>
    <script type="text/javascript" src="./script.js"></script>
</head>

<body>
<div id="container">

    <div class="sidebar">
    <div class="sidebar_fixeditem">
        <ul>
            <li>新規作成用ツール</li>
                <ul>
                    <li><a href="#section_forTemplate">索引拾いのテンプレート生成</a></li>
                    <li><a href="#section_forYomi">読みがなの取得</a></li>
                    <li><a href="#section_forHairetsu">配列読みに変換</a></li>
                    <li><a href="#section_forKatahira">カタカナひらがな相互変換</a></li>
                    <li><a href="#section_forNayose">名寄せ</a></li>
                    <li><a href="#section_forCheckChild">子項目候補の確認</a></li>
                    <li><a href="#section_forCheckNombre">ノンブル並びの確認</a></li>
                    <li><a href="#section_forCheckMiyo">見よ項目の確認</a></li>
                    <li><a href="#section_forAdjustNombre">ノンブル加算減算</a></li>
                </ul>
            <li>旧版再利用ツール</li>
                <ul>
                    <li><a href="#section_forComplete">子項目の復元</a></li>
                    <li><a href="#section_forRelease">名開き</a></li>
                </ul>
        </ul>
        <div class="sidebar_promotion">
            <p><a href="https://github.com/AWtnb/sakuin-tool" target="_blank"><img src="./image/github-mark.png"></a></p>
        </div>
    </div>
</div>

<div class="main">
<h1>索引作成補助ツール</h1>


<!-- ======================================================================
新規作成用
====================================================================== -->
<h2 id="section_forCreate">新規作成用ツール</h2>

<!-- ========================================
入力テンプレートの作成
======================================== -->
<h3 id="section_forTemplate">索引拾いのテンプレート生成</h3>

<div class="caption">
    <div class="imagebox">
        <div class="boxtitle">SAMPLE1</div>
        <img src="./image/img_generate-template.png">
    </div>
    <div class="imagebox">
        <div class="boxtitle">SAMPLE2</div>
        <img src="./image/img_generate-index.png">
    </div>
    <ul>
        <li>索引拾いのための Excel テンプレートを作成します。</li>
        <li>各ページの項目数を上図 SAMPLE1 のように Excel に整理して下記ボックスに貼り付けてください。</li>
        <li>“index” 列に条件付き書式で「偶数の場合に背景色変更」という設定をするとページの変わり目が見やすくなり便利です（SAMPLE2）。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_toGenerate">
    <div class="horizontal">
        <form class="generate">
            <textarea class="userInput" placeholder="図のように Excel から貼り付けてください"></textarea>
            <input type="button" value="生成" onclick="clickBtn_generate()" class="button">
            <input type="button" value="表をコピー" onclick="clickBtn_generate_copy()" class="button">
        </form>
    </div>

    <table  class="resultTable">
        <tr>
            <td>ID</td>
            <td>index</td>
            <td>ページ</td>
            <td>項目</td>
        </tr>
    </table>
</div>


<!-- ========================================
読み情報の取得
======================================== -->
<h3 id="section_forYomi">読みがなの取得</h3>

<div class="caption">
    <ul>
        <li>最初の計算時は解析辞書読み込みのために少し時間がかかります。</li>
        <li>正しく読み情報が取得できているか必ず事後確認をしてください。</li>
        <li>Microsoft Excel は安定ソート（<a href="https://ja.wikipedia.org/wiki/%E5%AE%89%E5%AE%9A%E3%82%BD%E3%83%BC%E3%83%88" target="_blank">Wikipedia</a>）です。<br>最初から配列読みでソートすると濁音・半濁音が混じってしまうため、Excel シート上では下記の順番でソートすることをおすすめします。</li>
        <ol>
            <li>元の項目名</li>
            <li>本機能で取得した読み</li>
            <li>配列読み（<a href="#section_forHairetsu">下記</a>で取得）</li>
        </ol>
    </ul>
</div>

<div class="userinterface" id="userinterface_forYomi">
    <div class="horizontal">
        <form class="yomi">
            <textarea class="userInput" placeholder="文字列を貼り付けてください"></textarea>
            <input type="button" value="取得" onclick="clickBtn_yomi()" class="button">
            <textarea class="displayResult" placeholder="ここに結果が表示されます" readonly></textarea>
            <input type="button" value="コピー" onclick="clickBtn_yomi_copy()" class="button">
        </form>
    </div>
</div>

<!-- ========================================
配列読みの取得
======================================== -->
<h3 id="section_forHairetsu">配列読みに変換</h3>

<div class="caption">
    <p>テキストボックスに入力された文字列を配列読みに変換します。</p>
</div>

<div class="userinterface" id="userinterface_forHairetsu">
    <form class="removeFlag">
        <input type="checkbox" class="removeFlag"> ひらがな・カタカナ・数字以外を削除する
    </form>
    <div class="horizontal">
        <form class="hairetsu">
            <textarea class="userInput" placeholder="文字列を貼り付けてください"></textarea>
            <input type="button" value="変換" onclick="clickBtn_hairetsu()" class="button">
            <textarea class="displayResult" readonly placeholder="ここに結果が表示されます"></textarea>
            <input type="button" value="コピー" onclick="clickBtn_hairetsu_copy()" class="button">
        </form>
    </div>
</div>



<!-- ========================================
カタカナひらがな相互変換
======================================== -->
<h3 id="section_forKatahira">カタカナひらがな相互変換</h3>
<div class="caption">
    <p>テキストボックスに入力された文字列をカタカナ／ひらがなに変換します。</p>
</div>

<div class="userinterface" id="userinterface_forKatahira">
    <form class="katahiraFlag">
        <label><input type="radio" name="radio1" value="toKata" checked>ひらがな→カタカナ</label>
        <label><input type="radio" name="radio1" value="toHira"        >カタカナ→ひらがな</label>
    </form>
    <div class="horizontal">
        <form class="convert">
            <textarea class="userInput" placeholder="文字列を貼り付けてください"></textarea>
            <input type="button" value="変換" onclick="clickBtn_katahira()" class="button">
            <textarea class="displayResult" placeholder="結果が表示されます" readonly></textarea>
            <input type="button" value="コピー" onclick="clickBtn_katahira_copy()" class="button">
        </form>
    </div>
</div>


<!-- ========================================
名寄せ
======================================== -->
<h3 id="section_forNayose">名寄せ</h3>
<div class="caption">
    <ul>
        <li>ノンブルを昇順で名寄せします。重複を整理し、3以上連続するノンブルをハイフンでつなぎます。</li>
        <li>ノンブルに半角数字以外が含まれている場合、「ソート」「重複整理」「ハイフンつなぎ」のいずれも行われません。</li>
        <li>項目列ではソートしません。</li>
        <li>見よ項目など、ノンブルが記入されていない場合はそのまま表示します。</li>
    </ul>
    <div class="imagebox">
        <div class="boxtitle">SAMPLE</div>
        <img src = "./image/img_nayose.png">
    </div>
</div>

<div class="userinterface" id="userinterface_forNayose">
    <form class="nombreLeftFlag">
        <input type="checkbox" class="isLeft"> ←ノンブルが左列（上図と逆）の場合はチェック
    </form>
    <div class="horizontal">
        <form class="nayose">
            <textarea class="userInput" placeholder="上図のように Excel からコピー＆ペーストしてください"></textarea>
            <input type="button" value="名寄せ" onclick="clickBtn_nayose()" class="button">
            <textarea class="displayResult" placeholder="結果が表示されます" readonly></textarea>
            <input type="button" value="コピー" onclick="clickBtn_nayose_copy()" class="button">
        </form>
    </div>
</div>

<!-- ========================================
子項目候補の確認
======================================== -->

<h3 id="section_forCheckChild">子項目候補の確認</h3>
<div class="caption">
    <ul>
        <li>名寄せ済みの索引に対して子項目の候補を探します。</li>
        <li>機械的な検索なので必ず目でも確認してください。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_forCheckChild">
    <form class="searchPos">
        <label><input type="radio" name="radio1" value="tail" checked>末尾一致</label>
        <label><input type="radio" name="radio1" value="head"        >先頭一致</label>
        <label><input type="radio" name="radio1" value="all"         >両方</label>
    </form>
    <div class="horizontal">
        <form class="check">
            <textarea class="userInput" placeholder="名寄せした索引をコピー＆ペーストしてください"></textarea>
            <input type="button" value="チェック" onclick="clickBtn_checkChild()" class="button">
        </form>
    </div>

    <div class="displayResult">
    </div>
</div>


<!-- ========================================
ノンブル並びの確認
======================================== -->

<h3 id="section_forCheckNombre">ノンブル並びの確認</h3>
<div class="caption">
    <ul>
        <li>チェック内容：</li>
        <ul>
            <li>ノンブルが正しく並んでいないもの</li>
            <li>3つ連続しているもの</li>
        </ul>
        <li>カンマの全角半角は区別しません。</li>
        <li>ノンブルに半角数字以外が含まれている場合は正しく判定できません。</li>
        <li>機械的な検索なので必ず目でも確認してください。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_forCheckNombre">
    <div class="horizontal">
        <form class="check">
            <textarea class="userInput" placeholder="名寄せした索引をコピー＆ペーストしてください"></textarea>
            <input type="button" value="チェック" onclick="clickBtn_checkNombre()" class="button">
        </form>
    </div>

    <div class="displayResult">
    </div>
</div>


<!-- ========================================
見よ項目の確認
======================================== -->

<h3 id="section_forCheckMiyo">見よ項目の確認</h3>
<div class="caption">
    <ul>
        <li>チェック内容：</li>
        <ul>
            <li>見よ項目があるのに参照先に括弧で付記されていないもの</li>
            <li>参照元として括弧書きされているのに見よ項目がないもの</li>
        </ul>
        <li>機械的な検索なので必ず目でも確認してください。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_forCheckMiyo">
    <div class="horizontal">
        <form class="check">
            <textarea class="userInput" placeholder="索引をコピー＆ペーストしてください"></textarea>
            <input type="button" value="チェック" onclick="clickBtn_checkMiyo()" class="button">
        </form>
    </div>

    <div class="displayResult">
    </div>
</div>


<!-- ========================================
ノンブル加算減算
======================================== -->
<h3 id="section_forAdjustNombre">ノンブル加算減算</h3>
<div class="caption">
    <ul>
        <li>名寄せされた索引に対して、指定範囲でノンブルを増やしたり減らしたりします。</li>
        <li>ノンブルに数字以外が含まれていた場合は計算の対象外です。</li>
        <ul>
            <li>範囲を示すハイフンなどが含まれる場合もスキップします。<br><strong>必ず目でも再確認してください。</strong></li>
        </ul>
    </ul>
</div>

<div class="userinterface" id="userinterface_forAdjustNombre">
    <div class="horizontal">
        <label>開始ノンブル<input type="number" value="1" min="1" class="startNombre"></label>
        <label>終了ノンブル<input type="number" value="99" min="1" class="endNombre"></label>
        <label>増分<input type="number" value="1" class="nombreDelta"></label>
    </div>
    <p><label><input type="checkbox" class="fullWidthCommaFlag">ノンブル間は全角カンマ</label></p>
    <div class="horizontal">
        <form class="adjustNombre">
            <textarea class="userInput" placeholder="名寄せされた索引を貼り付けてください"></textarea>
            <input type="button" value="計算" onclick="clickBtn_adjustNombre()" class="button">
            <textarea class="displayResult" placeholder="結果が表示されます" readonly></textarea>
            <input type="button" value="コピー" onclick="clickBtn_adjustNombre_copy()" class="button">
        </form>
    </div>
    <div class="displayResult">
    </div>
</div>


<!-- ======================================================================
旧版の活用
====================================================================== -->
<h2 id="section_forReuse">旧版再利用ツール</h2>

<!-- ========================================
子項目の復元
======================================== -->
<h3 id="section_forComplete">子項目の復元</h3>

<div class="caption">
    <div class="imagebox">
        <div class="boxtitle">SAMPLE</div>
        <img src="./image/img_complete.png">
    </div>
    <ul>
        <li>索引項目中の子項目を復元します（上図）。</li>
        <li>ノンブルが入っていても動作します。</li>
        <li>改訂時に旧版の索引を再利用する際などにご利用ください。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_toComplete">
    <label>項目とノンブルの間の文字（ノンブルが入っていない場合はどちらを選択しても同じ結果になります）：</label>
    <form class="delimiter">
        <input type="radio" name="radio1" value="spaces" checked> 二倍アキ
        <input type="radio" name="radio1" value="tab"          > タブ文字（Excel）
    </form>
    <div class="horizontal">
        <form class="complete">
            <textarea class="userInput" placeholder="索引を貼り付けてください"></textarea>
            <input type="button" value="復元" onclick="clickBtn_complete()" class="button">
            <textarea class="displayResult" placeholder="結果が表示されます" readonly></textarea>
            <input type="button" value="コピー" onclick="clickBtn_complete_copy()" class="button">
        </form>
    </div>
</div>


<!-- ========================================
名開き
======================================== -->
<h3 id="section_forRelease">名開き</h3>

<div class="caption"><div class="imagebox">
    <div class="boxtitle">SAMPLE</div>
        <img src="./image/img_release.png">
    </div>
    <ul>
        <li>名寄せされた状態の索引を「項目－ノンブル」の1対1対応に戻します（上図）。</li>
        <li>子項目や見よ項目はそのまま残ります。</li>
        <li>改訂時に旧版の索引を再利用する際などにご利用ください。</li>
        <li>項目とノンブル間が2倍アキで区切られた、テキスト形式の索引でも動作します。</li>
        <li>タブ文字（Excel）もしくは2倍アキで項目とノンブルを区別しています。<br>「日　　本」などと字間に2つ以上スペースが含まれていると正常に動作しませんのでご注意ください。</li>
    </ul>
</div>

<div class="userinterface" id="userinterface_forRelease">
    <div class="horizontal">
        <form class="release">
            <textarea class="userInput" placeholder="名寄せ済みの文字列を貼り付けてください"></textarea>
            <input type="button" value="名開き" onclick="clickBtn_release()" class="button">
            <input type="button" value="表をコピー" onclick="clickBtn_release_copy()" class="button">
        </form>
    </div>

    <table class="resultTable">
        <tr>
            <td>項目</td>
            <td>ノンブル</td>
        </tr>
    </table>
</div>


</div>

</div>

<script src="https://cdn.jsdelivr.net/npm/ie-buster@1.1.0/dist/ie-buster.min.js"></script>

</body>


</html>
