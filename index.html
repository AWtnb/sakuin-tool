<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>sakuin-tool</title>
    <link rel="stylesheet" type="text/css" href="style.css">
    <script src="./kuromoji.js"></script>
    <script type="text/javascript" src="./script.js"></script>
</head>

<body>
<div id="container">
<h1>索引作成補助ツール</h1>

<h2>新規作成用ツール</h2>

<!-- ======================================== 
読み情報の取得
======================================== -->
<h3>読みがなの取得</h3>

<div>
<ul>
<li><b>Internet explorer では動作しません！</b></li>
<li>最初の計算時は解析辞書読み込みのために少し時間がかかります。</li>
<li>正しくよみがなが取得できているか必ず事後確認をしてください。</li>
</ul>
</div>


<div style="display:inline-flex"><form name="form_toYomi">
<textarea name="textarea1" cols="25" rows="20" value="1" placeholder="文字列を貼り付けてください"></textarea>
<input type="button" value="取得" onclick="clickBtn_yomi()"/>
<textarea name="textarea2" cols="25" rows="20" value="1" placeholder="ここに結果が表示されます" readonly></textarea>
<input type="button" value="コピー" onclick="clickBtn_yomi_copy()"/>
</form></div>

<script>
function clickBtn_yomi() {
    let lines = document.form_toYomi.textarea1.value;
    setYomi(lines);
}
function clickBtn_yomi_copy() {
    document.form_toYomi.textarea2.select()
    document.execCommand("Copy");
    alert("コピーしました！");
}
</script>

<!-- ======================================== 
配列読みの取得
======================================== -->
<h3>配列読みに変換</h3>
<p>テキストボックスに入力された文字列を配列読みに変換します。</p>
<form name="form_removeFlag">
<input type="checkbox" name="removeFlag" value="remove"> ひらがな・カタカナ・数字以外を削除する
</form>

<div style="display:inline-flex"><form name="form_toHairetsu">
<textarea name="textarea1" cols="25" rows="20" value="1" placeholder="文字列を貼り付けてください"></textarea>
<input type="button" value="変換" onclick="clickBtn_hairetsu()"/>
<textarea name="textarea2" cols="25" rows="20" value="1" readonly placeholder="ここに結果が表示されます"></textarea>
<input type="button" value="コピー" onclick="clickBtn_hairetsu_copy()"/>
</form></div>

<script>
function clickBtn_hairetsu() {
    const lines_toHairetsu = document.form_toHairetsu.textarea1.value;
    const removeFlag = document.form_removeFlag.removeFlag;
    let converted = [];
    if (removeFlag.checked) {
        converted = toHairetsu(lines_toHairetsu, true);
    }
    else {
        converted = toHairetsu(lines_toHairetsu, false);
    }
    const msg = converted.join("\n");
    document.form_toHairetsu.textarea2.value = msg;
}
function clickBtn_hairetsu_copy() {
    document.form_toHairetsu.textarea2.select();
    document.execCommand("Copy");
    alert("コピーしました！");
}
</script>

<!-- ======================================== 
名寄せ
======================================== -->
<h3>名寄せ</h3>
<ul>
<li>ソート機能はありません。上から表示されている順番通りに名寄せします。</li>
<li>見よ項目など、ノンブルが記入されていない場合はそのまま表示します。</li>
<li>子項目は手動で作成してください。</li>
</ul>

<p><img src = "https://i.gyazo.com/3ab3b7d640fa94adb97b06fc96658789.png"></p>

<div style="display:inline-flex"><form name="form_toNayose">
<textarea name="textarea1" cols="25" rows="20" value="1" placeholder="文字列を貼り付けてください"></textarea>
<input type="button" value="名寄せ" onclick="clickBtn_nayose()"/>
<textarea name="textarea2" cols="25" rows="20" value="1" placeholder="結果が表示されます" readonly></textarea>
<input type="button" value="コピー" onclick="clickBtn_nayose_copy()"/>
</form></div>

<script>
function clickBtn_nayose() {
    const lines_toNayose = document.form_toNayose.textarea1.value;
    const nys = nayose(lines_toNayose);
    const msg = nys.join("\n");
    document.form_toNayose.textarea2.value = msg;
}
function clickBtn_nayose_copy() {
    document.form_toNayose.textarea2.select();
    document.execCommand("Copy");
    alert("コピーしました！");
}
</script>

<!-- ======================================== 
カタカナひらがな相互変換
======================================== -->
<h3>カタカナひらがな相互変換</h3>
<p>テキストボックスに入力された文字列をカタカナ／ひらがなに変換します。</p>

<form id="form_katahiraFlag">
<label><input type="radio" name="radio1" value="toKata" checked>ひらがな→カタカナ</label>
<label><input type="radio" name="radio1" value="toHira"        >カタカナ→ひらがな</label>
</form>

<p></p>

<div style="display:inline-flex"><form name="form_toConvert">
<textarea name="textarea1" cols="25" rows="20" value="1" placeholder="文字列を貼り付けてください"></textarea>
<input type="button" value="変換" onclick="clickBtn_katahira()"/>
<textarea name="textarea2" cols="25" rows="20" value="1" placeholder="結果が表示されます" readonly></textarea>
<input type="button" value="コピー" onclick="clickBtn_katahira_copy()"/>
</form></div>

<script>
function clickBtn_katahira() {
    const lines_toConvert = document.form_toConvert.textarea1.value;
    let element = document.getElementById("form_katahiraFlag");
    let radioList = element.radio1;
    let mode = radioList.value;
    if (mode == "toKata") {
        msg = hira2kata(lines_toConvert);
    }
    else {
        msg = kata2hira(lines_toConvert);
    }
    document.form_toConvert.textarea2.value = msg;
}
function clickBtn_katahira_copy() {
    document.form_toConvert.textarea2.select();
    document.execCommand("Copy");
    alert("コピーしました！");
}
</script>

<h2>旧版再利用ツール</h2>

<!-- ======================================== 
名開き
======================================== -->
<h3>名開き</h3>
<img src="https://i.gyazo.com/1cf1286b016173909636921bdf18d68e.png" height="300">
<div>
    <ul>
    <li><b>Internet explorer 非推奨！</b></li>
    <li>名寄せされた状態の索引を「項目－ノンブル」の1対1対応に戻します（上図）。</li>
    <li>子項目や見よ項目はそのまま残ります。</li>
    <li>改訂時に旧版の索引を再利用する際などにご利用ください。</li>
    </ul>
</div>

「項目」と「ノンブル」の間の文字：
<form name="form_delimiter">
    <input type="radio" name="delim1" value="　　" checked> 2倍アキ
    <input type="radio" name="delim1" value="\t" > タブ（Excel）
</form>
「ノンブル」列のカンマの種類：
<form name="form_nombreConnector">
    <input type="radio" name="connect1" value="，" checked> 全角モノ
    <input type="radio" name="connect1" value="," > 半角モノ
</form>


<form name="form_toRelease">
<textarea name="textarea1" cols="40" rows="10" value="1" placeholder="名寄せ済みの文字列を貼り付けてください"></textarea>
<input type="button" value="名開き" onclick="clickBtn_release()"/>
<input type="button" value="表をコピー" onclick="clickBtn_release_copy()"/>
</form>

<table id="releaseTable" border="double">
    <tr>
        <td>項目</td>
        <td>ノンブル</td>
    </tr>
</table>

<script>
    function clickBtn_release() {
        let delimiter = "\t"
        const delimRadioBtn = document.form_delimiter.delim1;
        for (let i = 0; i < delimRadioBtn.length; i++){
            if(delimRadioBtn[i].checked){
                delimiter = delimRadioBtn[i].value;
                break;
            }
        }

        let nombreConnector = "，"
        const commaRadioBtn = document.form_nombreConnector.connect1;
        for (let j = 0; j < commaRadioBtn.length; j++){
            if(commaRadioBtn[j].checked){
                nombreConnector = commaRadioBtn[j].value;
                break;
            }
        }
        const linesToRelease = document.form_toRelease.textarea1.value;
        const releasedObj = releaseNayoseLines(linesToRelease, nombreConnector, delimiter);

        const resultTable = document.getElementById("releaseTable");
        const maxRow = resultTable.rows.length;
        if (maxRow > 1) {
            for (let r = maxRow - 1; r >= 1; r--) {
                resultTable.deleteRow(r);
            }
        }
        for (let item in releasedObj) {
            let row = resultTable.insertRow(-1);
            let cell1 = row.insertCell(0);
            let cell2 = row.insertCell(1); 
            cell1.innerHTML = releasedObj[item].name;
            cell2.innerHTML = releasedObj[item].nombre;
        }
    }

    function clickBtn_release_copy() {
        const range = document.createRange();
        const result = document.getElementById("releaseTable");
        range.selectNodeContents(result);
        const selection = window.getSelection();
        selection.removeAllRanges();
        selection.addRange(range);
        document.execCommand("Copy");
        alert("コピーしました！");
    }
</script>

<!-- ======================================== 
子項目の復元
======================================== -->
<h3>子項目の復元</h3>
<img src="https://i.gyazo.com/2bbc343e73bcd735473dd7082abbba43.png" height="200">
<div>
    <ul>
    <li><b>Internet explorer 非推奨！</b></li>
    <li>索引項目中の子項目を復元します（上図）。</li>
    <li>改訂時に旧版の索引を再利用する際などにご利用ください。</li>
    </ul>
</div>

見出し項目の代わりに入っている横線の種類：
<form name="form_filler">
    <input type="radio" name="filler1" value="――" checked> ――（ホリゾンタルバー×2）
    <input type="radio" name="filler1" value="──" > ──（横罫線×2）
</form>

<div style="display:inline-flex"><form name="form_toComplete">
<textarea name="textarea1" cols="25" rows="20" value="1" placeholder="索引の項目を貼り付けてください"></textarea>
<input type="button" value="復元" onclick="clickBtn_complete()"/>
<textarea name="textarea2" cols="25" rows="20" value="1" placeholder="結果が表示されます" readonly></textarea>
<input type="button" value="コピー" onclick="clickBtn_complete_copy()"/>
</form></div>

<script>
    function clickBtn_complete() {
        let fillerType = "――"
        const fillerRadioBtn = document.form_filler.filler1;
        for (let i = 0; i < fillerRadioBtn.length; i++){
            if(fillerRadioBtn[i].checked){
                fillerType = fillerRadioBtn[i].value;
                break;
            }
        }
        const lines_toComplete = document.form_toComplete.textarea1.value;
        const completedArray = completehildItem(lines_toComplete, fillerType);
        document.form_toComplete.textarea2.value = completedArray.join("\n");
    }
    function clickBtn_complete_copy() {
        document.form_toComplete.textarea2.select();
        document.execCommand("Copy");
        alert("コピーしました！");
    }
</script>

</div>
</body>
<!-- ========================================
footer
======================================== -->
<footer>
<p><img src="https://img.icons8.com/small/16/000000/github.png"/> <a href="https://github.com/AWtnb/sakuin-tool" target="_blank">Github repository</a></p>
</footer>
</html>