<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>見よ項目の名寄せをチェック</title>
    <base target="_blank">
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../almond.lite.css">
    <link rel="stylesheet" type="text/css" href="../additional.css">
</head>

<body>
    <!-- ============================== -->
    <div class="container">

        <h1>見よ項目の名寄せをチェック</h1>

        <div class="ui">
            <textarea class="inputLines" placeholder="paste here!"></textarea>
            <input type="button" value="チェック" id="exeButton">

            <ul>
                <li>下記のチェックを行います。
                    <ul>
                        <li>見よ<b>先</b>項目も正しく名寄せされているか</li>
                        <li>見よ項目が本項目として残っていないか</li>
                    </ul>
                </li>
                <li>名寄せを修正したら<a href="../CheckNombre/index.html">こちら</a>でノンブルなど再チェックしておくと安全です。</li>
            </ul>

            <div class="result-markup"></div>

        </div>



    </div>
    <!-- ============================== -->
    <script type="module">
        import {setNavi} from "../common.js"
        setNavi();

        import {GroupingChecker} from "./src.js";

        document.querySelector("#exeButton").addEventListener("click", () => {
            const elem = document.querySelector(".ui");
            const output = elem.querySelector(".result-markup");
            output.innerHTML = "";
            const checker = new GroupingChecker(".ui .inputLines");
            const ungrouped = checker.getUngrouped();
            if (ungrouped.length) {
                output.innerHTML = output.innerHTML + `<div><h4>見よ先項目が名寄せされずに残っています！</h4><ul>${ungrouped.join("")}</ul></div>`;
            }
            const conflict = checker.getConflicting();
            if (conflict.length) {
                output.innerHTML = output.innerHTML + `<div><h4>見よ項目が本項目として残っています！</h4><ul>${conflict.join("")}</ul></div>`;
            }
            if (output.innerHTML.length < 1) {
                output.innerHTML = '<div class="msg">問題ありません！</div>';
            }
        });


    </script>
</body>

</html>