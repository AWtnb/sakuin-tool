<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>名寄せのチェック</title>
    <base target="_blank">
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../style.css">
    <style>
        .result .msg {
            font-size: .9rem;
            font-weight: bold;
        }
        .result .detail {
            font-size: .9rem;
            line-height: 1.2;
        }
        .result .detail p {
            margin: 1em 0;
        }
    </style>
</head>

<body>
<!-- ============================== -->
<div class="container">


<h2>名寄せのチェック</h2>

<div class="caption">
    <p>名寄せを修正したら<a href="../CheckNombre/index.html">こちら</a>でノンブルなど再チェックしておくと安全です。</p>
</div>

<h3>名寄せ漏れがないか</h3>

<div class="ui check-non-grouped">
    <textarea class="inputLines"placeholder="paste here!" ></textarea>
    <input type="button" value="チェック" onclick="click_checkNonGrouped()">

    <div class="result"></div>

</div>

<h3>見よ項目が本項目として残っていないか</h3>

<div class="ui check-illegal-item">
    <textarea class="inputLines"placeholder="paste here!" ></textarea>
    <input type="button" value="チェック" onclick="click_checkIllegalItem()">

    <div class="result"></div>

</div>

</div>
<!-- ============================== -->
<script type="text/javascript" src="../util.js" defer></script>
<script type="text/javascript" src="./src.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/ie-buster@1.1.0/dist/ie-buster.min.js"></script>
<script>

function click_checkNonGrouped(){
    const elem = document.querySelector(".check-non-grouped");
    const output = elem.querySelector(".result");
    output.innerHTML = "";
    const lines = multiline2array(elem.querySelector(".inputLines").value);
    const found = getDuplicatedItemsInNayose(lines);
    if (found.length) {
        const markup = found.map(arr => `<p>${arr.join("<br>")}</p>`).join("");
        output.innerHTML = `<div class="msg">名寄せできていない項目が見つかりました！</div><div class="detail">${markup}</div>`;
    }
    else {
        output.innerHTML = "<div class=\"msg\">問題ありません！</div>";
    }
}

function click_checkIllegalItem() {
    const elem = document.querySelector(".check-illegal-item");
    const output = elem.querySelector(".result");
    output.innerHTML = "";
    const lines = multiline2array(elem.querySelector(".inputLines").value);
    const found = [];
    if (found.length) {
        const markup = found.map(arr => `<p>${arr.join("<br>")}</p>`).join("");
        output.innerHTML = `<div class="msg">見よ項目が本項目としても残っています！</div><div class="detail">${markup}</div>`;
    }
    else {
        output.innerHTML = "<div class=\"msg\">問題ありません！</div>";
    }
}

</script>
</body>

</html>
