<!DOCTYPE html>
<html lang="ja">

<head>
    <meta charset="utf-8">
    <title>見よ項目のノンブルをチェック</title>
    <base target="_blank">
    <link rel="shortcut icon" href="../favicon.ico">
    <link rel="stylesheet" type="text/css" href="../style.css">
    <style>
        .result .msg {
            font-weight: bold;
        }
        .result .detail {
            padding: 2px 1em;
            max-height: 20em;
            overflow: scroll;
        }
        .result .detail p {
            font-size: .9rem;
            margin: 0;
        }
    </style>
</head>

<body>
<!-- ============================== -->
<div class="container">


<h2>見よ項目のノンブルをチェック</h2>

<div class="ui">
    <textarea class="inputLines" placeholder="名寄せした索引をコピー＆ペーストしてください"></textarea>
    <input type="button" value="チェック" onclick="click_check()">

    <div class="result"></div>

</div>

</div>
<!-- ============================== -->
<script type="text/javascript" src="../util.js" defer></script>
<script type="text/javascript" src="./src.js" defer></script>
<script src="https://cdn.jsdelivr.net/npm/ie-buster@1.1.0/dist/ie-buster.min.js"></script>
<script>

function click_check(){
    const elem = document.querySelector(".ui");
    const output = elem.querySelector(".result");
    output.innerHTML = "";
    const lines = multiline2array(elem.querySelector(".inputLines").value);
    const found = grepNombredReference(lines);
    if (found.length) {
        const markupNombreToRemove = found.map(x => `<p>${x}</p>`).join("\r\n");
        const markupItemToAddNombre = grepItemToAddNombre(found).map(item => {
            return `<p>${item.ReferTo}　←${item.Nombre}</p>`
        }).join("\r\n");
        output.innerHTML = `<div class="msg">見よ項目にノンブルが残っています：</div><div class="detail">${
            markupNombreToRemove
        }</div><div class="msg">見よ先にノンブルを追加する必要があります：</div><div class="detail">${
            markupItemToAddNombre
        }</div>`;
    }
}

function click_copy() {
    copyValue(document.querySelector(".ui .result"));
}

</script>
</body>

</html>
