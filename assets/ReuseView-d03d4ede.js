import{S as V}from"./SectionEnd-92dbd953.js";import{P as L}from"./PasteBox-86529bff.js";import{R as A}from"./ResultBox-c06d7467.js";import{_ as F,i as v,j as f,o as p,a as h,b as c,u as y,e as n,t as C,F as w,g as R,h as U,p as T,d as j,f as b,r as x}from"./index-b6e9e327.js";import{E,A as H}from"./entryHandler-ea7f15d2.js";import{C as N}from"./CopyButton-f764926e.js";const W=u=>{const t=String(u).match(/\d[\d,\u2013]*$/);return t?t[0]:""},O=["‐","‑","‒","–","—","―","－","─","-"],D=u=>{let t=u.split(",")[0];return t=t.replace(/\d+$/,""),O.includes(t.at(-1))&&t.at(-2).match(/\d/)&&(t=t.replace(/.$/,""),t=t.replace(/\d+$/,"")),t};class B{constructor(t){this.valiation=O,this.rawStr=t}format(t="–"){let e=this.rawStr;return this.valiation.forEach(r=>{e=e.replaceAll(r,"-")}),e.replace(/\u002d+/g,t)}getHeaderLen(){let t=0;for(let e=0;e<this.rawStr.length&&this.valiation.includes(this.rawStr[e]);e++)t+=1;return t}getTrailerLen(){let t=0;for(let e=this.rawStr.length-1;0<=e&&this.valiation.includes(this.rawStr[e]);e--)t+=1;return t}formatChildEntry(){const t=this.getHeaderLen(),e=t>0?"――":"",r=this.getTrailerLen(),d=r>0?"――":"";return e+this.rawStr.slice(t,this.rawStr.length-r)+d}}class P{constructor(t){this.prefix=t.startsWith(" ")||t.startsWith("　")?"　":"";const e=String(t).replace(/\uff0c/g,",").replace(/\s+/g,""),r=W(new B(e).format());if(r.length>0){this.address=r.replaceAll(",",", "),this.name=D(e);return}if(this.address="",e.indexOf("→")!=-1){this.name=e.replace(/→/,"　→");return}this.name=e}getFormattedLine(){const t=this.prefix+new B(this.name).formatChildEntry();return this.address.length>0?t+"　　"+this.address:t}}const I=u=>(T("data-v-8ac79efa"),u=u(),j(),u),q=I(()=>n("h2",null,"ゲラから抽出した索引データの整形",-1)),z=I(()=>n("ul",null,[n("li",null,[n("strong",null,"ゲラからテキストを抽出すると長い行が折り返されて改行になっていることがあります。"),n("ul",null,[n("li",null,"そうした箇所は先に手動で整形してください。")])]),n("li",null,"見よ項目の矢印の前のアキを1倍モノに統一します。"),n("li",null,[b("連続するノンブルを示すダーシの種類を"),n("code",null,"–"),b("（enダーシ）に統一します。")]),n("li",null,[b("子項目のダーシの種類を"),n("code",null,"――"),b("（2倍ダーシ）に統一します。")])],-1)),G={key:0},J={class:"detail"},K={class:"original"},M={class:"formatted"},Q={__name:"FormatOld",setup(u){const t=s=>s.map(l=>String(l).trimEnd().replace(/\t/,"　　")).map(l=>({formatted:new P(l).getFormattedLine(),original:l})),e=v(""),r=v([]),d=v(""),g=f(()=>e.value.split(/\n/).map(l=>String(l))),_=f(()=>r.value.map(s=>s.formatted).join(`
`)),a=f(()=>r.value.filter(s=>s.formatted!=s.original)),i=()=>{r.value=[]},o=()=>{i(),r.value=t(g.value),a.value.length>0?d.value=a.value.length+"箇所を修正しました！":d.value="問題のある箇所は見当たりませんでした！"};return(s,l)=>(p(),h(w,null,[q,c(L,{onUpdateContent:l[0]||(l[0]=m=>e.value=m.target.value),onButtonClicked:o}),z,c(A,{result:y(_)},null,8,["result"]),n("div",null,[n("h4",null,C(d.value),1),y(a).length?(p(),h("ol",G,[(p(!0),h(w,null,R(y(a),(m,S)=>(p(),h("li",{key:S},[n("ul",J,[n("li",K,C(m.original),1),n("li",M,C(m.formatted),1)])]))),128))])):U("",!0)])],64))}},X=F(Q,[["__scopeId","data-v-8ac79efa"]]),Y="/sakuin-tool/assets/resolveChild-958e8e93.png",Z=n("h2",null,"子項目の復元",-1),tt=n("div",null,[n("img",{src:Y,alt:""})],-1),et={__name:"ResolveChild",setup(u){const t=o=>{const s=[],l=[];s.push(o[0]),l.push(new E(o[0]).basename);for(let m=1;m<o.length;m++){const S=new E(o[m]),$=S.basename;if($.startsWith("――")){const k=l.at(-1)+$.substring(2);s.push(k+"　　"+S.address)}else if($.endsWith("――")){const k=$.substring(0,$.length-2)+l.at(-1);s.push(k+"　　"+S.address)}else s.push(S.rawStr),l.push($)}return s},e=v(""),r=v([]),d=f(()=>e.value.split(/\n/).map(s=>String(s))),g=f(()=>d.value.map(o=>o.trim()).filter(o=>o.length)),_=f(()=>r.value.join(`
`)),a=()=>{r.value=[]},i=()=>{a(),r.value=t(g.value)};return(o,s)=>(p(),h(w,null,[Z,c(L,{onUpdateContent:s[0]||(s[0]=l=>e.value=l.target.value),onButtonClicked:i}),c(A,{result:y(_)},null,8,["result"]),tt],64))}},nt="/sakuin-tool/assets/ungroup-57a732db.png",st={name:"UngroupedTable",props:{lines:Array,resultStr:String},components:{CopyButton:N}},rt={key:0},ot={class:"limit-height"},lt=n("thead",null,[n("tr",null,[n("th",null,"項目"),n("th",null,"ノンブル")])],-1);function at(u,t,e,r,d,g){const _=x("CopyButton");return e.lines.length?(p(),h("div",rt,[n("div",ot,[n("table",null,[lt,n("tbody",null,[(p(!0),h(w,null,R(e.lines,(a,i)=>(p(),h("tr",{key:i},[n("td",null,C(a.name),1),n("td",null,C(a.nombre),1)]))),128))])])]),c(_,{copyStr:e.resultStr},null,8,["copyStr"])])):U("",!0)}const ut=F(st,[["render",at]]),it=n("h2",null,"名開き",-1),ct=n("div",null,[n("img",{src:nt,alt:""})],-1),dt={__name:"Ungroup",setup(u){const t=i=>{const o=[];return i.filter(s=>s.trim()).map(s=>s.replace("	","　　")).forEach(s=>{const l=new E(s);l.isReference?o.push({name:l.name,nombre:""}):new H(l.address).nombres.forEach(m=>{o.push({name:l.name,nombre:m.display.text})})}),o},e=v(""),r=v([]),d=f(()=>e.value.split(/\n/).map(o=>String(o))),g=f(()=>r.value.map(i=>`${i.name}	${i.nombre}`.trimEnd()).join(`
`)),_=()=>{r.value=[]},a=()=>{_(),r.value=t(d.value)};return(i,o)=>(p(),h(w,null,[it,c(L,{onUpdateContent:o[0]||(o[0]=s=>e.value=s.target.value),onButtonClicked:a}),c(ut,{lines:r.value,resultStr:y(g)},null,8,["lines","resultStr"]),ct],64))}},mt={name:"ReuseView",components:{SectionEnd:V,FormatOld:X,ResolveChild:et,Ungroup:dt}},pt={class:"reuse"},ht=n("h1",null,"旧版索引の再利用",-1);function _t(u,t,e,r,d,g){const _=x("FormatOld"),a=x("SectionEnd"),i=x("ResolveChild"),o=x("Ungroup");return p(),h("div",pt,[ht,c(_),c(a),c(i),c(a),c(o),c(a)])}const yt=F(mt,[["render",_t]]);export{yt as default};
