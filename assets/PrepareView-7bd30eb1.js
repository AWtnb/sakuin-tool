import{S as T}from"./SectionEnd-37178fba.js";import{U as k}from"./utils-e1f3c5ba.js";import{C as $}from"./CopyButton-d9fc40d0.js";import{P as b}from"./PasteBox-7e4fa53b.js";import{_,r as d,o as p,a as m,e as t,F as g,g as x,t as h,b as u,h as y,c as C,w as B,v as P,f}from"./index-42f53b86.js";const v={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:$}},E={key:0},H={class:"limit-height"},I=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),V=t("td",null,null,-1),F=t("td",null,null,-1);function N(e,n,s,c,i,r){const a=d("CopyButton");return s.lines.length?(p(),m("div",E,[t("div",H,[t("table",null,[I,t("tbody",null,[(p(!0),m(g,null,x(s.lines,(o,l)=>(p(),m("tr",{key:l},[t("td",null,h(o.id),1),t("td",null,h(o.pageIdx),1),t("td",null,h(o.page),1),V,F]))),128))])])]),u(a,{copyStr:s.resultStr},null,8,["copyStr"])])):y("",!0)}const U=_(v,[["render",N]]),w="/sakuin-tool/assets/generate-index-28f0eaa2.png",D="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",L={name:"ExcelSetting"},j=C('<summary>TIPS：条件付き書式の設定</summary><img src="'+w+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+D+'">',5),A=[j];function G(e,n,s,c,i,r){return p(),m("details",null,A)}const M=_(L,[["render",G]]),W="/sakuin-tool/assets/newtemplate-67fdefb0.png",O=e=>{const n=[];let s=0;return e.filter(c=>c).forEach(c=>{const[i,r,...a]=c.split("	"),o=k.toHalfWidth(r);if(Number(o)>0){s+=1;for(let l=0;l<Number(o);l++)n.push({id:String(n.length+1),pageIdx:String(s),page:String(i)})}}),n},q={name:"Pickup",data:function(){return{content:"",lines:[],skipHeader:!0}},components:{CopyButton:$,PasteBox:b,TemplateTable:U,ExcelSetting:M},computed:{contentLines:function(){const e=this.content.split(/\n/).map(n=>String(n));return this.skipHeader?e.slice(1):e},resultStr:function(){return["ID	index	ページ	項目	見よ先"].concat(this.lines.map(n=>`${n.id}	${n.pageIdx}	${n.page}		`)).join(`
`)}},methods:{reset:function(){this.lines=[]},executeGenerate:function(){this.reset(),O(this.contentLines).forEach(e=>{this.lines.push(e)})}}},z=t("h2",null,"索引拾いのテンプレート生成",-1),J=t("div",null,[t("img",{src:W,alt:""})],-1),K=t("p",null,[t("code",null,"個数"),f("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1);function Q(e,n,s,c,i,r){const a=d("PasteBox"),o=d("TemplateTable"),l=d("ExcelSetting");return p(),m(g,null,[z,t("label",null,[B(t("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=S=>e.skipHeader=S)},null,512),[[P,e.skipHeader]]),f("先頭行をスキップする")]),u(a,{onUpdateContent:n[1]||(n[1]=S=>e.content=S.target.value),onButtonClicked:r.executeGenerate},null,8,["onButtonClicked"]),u(o,{lines:e.lines,resultStr:r.resultStr},null,8,["lines","resultStr"]),J,K,u(l)],64)}const R=_(q,[["render",Q]]),X={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:$}},Y={key:0},Z={class:"limit-height"},tt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function et(e,n,s,c,i,r){const a=d("CopyButton");return s.lines.length?(p(),m("div",Y,[t("div",Z,[t("table",null,[tt,t("tbody",null,[(p(!0),m(g,null,x(s.lines,(o,l)=>(p(),m("tr",{key:l},[t("td",null,h(o.name),1),t("td",null,h(o.nombre),1)]))),128))])])]),u(a,{copyStr:s.resultStr},null,8,["copyStr"])])):y("",!0)}const nt=_(X,[["render",et]]),ot="/sakuin-tool/assets/preformat-9f6a2373.png",st=e=>{const n=[];return e.filter(s=>s.trim()).forEach(s=>{const[c,i,r,...a]=s.split("	").map(l=>l.trim()),o=String(k.toHalfWidth(c));String(r).length>0?(n.push({nombre:"",name:`${i}　→${r}`}),n.push({nombre:o,name:`${r}（${i}）`})):String(i).length>0&&n.push({nombre:o,name:i})}),n},lt={name:"Preformat",data:function(){return{content:"",lines:[],skipHeader:!0}},components:{CopyButton:$,PasteBox:b,FormattedTable:nt},computed:{contentLines:function(){const e=this.content.split(/\n/).map(n=>String(n));return this.skipHeader?e.slice(1):e},resultStr:function(){return this.lines.map(e=>`${e.name}	${e.nombre}`).join(`
`)}},methods:{reset:function(){this.lines=[]},executeFormat:function(){this.reset(),st(this.contentLines).forEach(e=>{this.lines.push(e)})}}},rt=t("h2",null,"入力済テンプレートの整形",-1),it=t("h3",null,"整形内容",-1),ct=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),f("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),f("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),at=t("div",null,[t("img",{src:ot,alt:""})],-1);function ut(e,n,s,c,i,r){const a=d("PasteBox"),o=d("FormattedTable");return p(),m(g,null,[rt,t("label",null,[B(t("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=l=>e.skipHeader=l)},null,512),[[P,e.skipHeader]]),f("先頭行をスキップする")]),u(a,{onUpdateContent:n[1]||(n[1]=l=>e.content=l.target.value),onButtonClicked:r.executeFormat},null,8,["onButtonClicked"]),it,ct,u(o,{lines:e.lines,resultStr:r.resultStr},null,8,["lines","resultStr"]),at],64)}const dt=_(lt,[["render",ut]]),pt={name:"PrepareView",components:{SectionEnd:T,Pickup:R,Preformat:dt}},mt={class:"pickup"},_t=t("h1",null,"事前準備",-1);function ht(e,n,s,c,i,r){const a=d("Pickup"),o=d("SectionEnd"),l=d("Preformat");return p(),m("div",mt,[_t,u(a),u(o),u(l),u(o)])}const bt=_(pt,[["render",ht]]);export{bt as default};
