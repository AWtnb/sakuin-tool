class o{constructor(e){this.reg=new RegExp("(（.+?）|［.+?］|\\(.+?\\)|\\[.+?\\])$"),this.name=e}getBasename(){return this.name.replace(this.reg,"").trim().replace(/\u3000{1,2}/,"")}getRefBasename(){return this.name.split("→")[0].trim()}getSource(){const e=this.name.match(this.reg);return e?e[0].slice(1,-1).trim().replace(/\uff0c/g,",").split(",").map(s=>String(s).trim()).filter(Boolean):[]}getReferTo(){const e=this.name.split("→").map(t=>String(t).trim()).filter(Boolean);return e.length==2?e.at(-1):""}}class m{constructor(e,t="　　"){this.rawStr=e,this.isChild=e.trim().length>0&&e.trimStart()!=e,this.separator=t,this.elems=this.rawStr.split(this.separator).filter(Boolean).map(s=>String(s)),this.name="",this.basename="",this.address="",this.referredFrom=[],this.referTo="",this.isReference=!1,this.parse()}parse(){if(this.elems.length>=2){const s=(()=>this.elems.length>2?{left:this.elems.slice(0,-1).join(this.separator),right:this.elems.at(-1)}:{left:this.elems[0],right:this.elems[1]})();this.name=(this.isChild?"　":"")+s.left.trim(),this.address=s.right.trim();const i=new o(this.name);this.basename=i.getBasename(),this.referredFrom=i.getSource();return}if(this.elems.length<1)return;const e=this.elems[0];if(e.trim().length<1)return;this.name=(this.isChild?"　":"")+e.trim();const t=new o(this.name);this.referTo=t.getReferTo(),this.isReference=this.referTo.length>0,this.basename=t.getRefBasename(),this.referredFrom=t.getSource()}}class r{constructor(e,t=!1){this.hyphenated=t,this.origin=e,this.display={text:this.origin.trim(),prefix:this.getPrefix(),suffix:this.getSuffix()},this.intValue=Number(this.display.text.replace(/[^\d]/g,""))}getPrefix(){const e=this.origin;return isNaN(e.at(0))?e.split(/\d+/).at(0):""}getSuffix(){const e=this.origin;return isNaN(e.at(-1))?e.split(/\d+/).at(-1):""}}class c{constructor(e){const t=e.replace(/\s/g,"").replace(/\uff0c/g,",").replace(/[\u002d\u2010\u2011\u2012\u2013\u2014\uFF0D]+/g,"-").replace(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g,function(s){return String.fromCharCode(s.charCodeAt(0)-65248)});this.rawElements=t.split(",").map(s=>s.trim()).filter(Boolean),this.nombres=[],this.parse()}parse(){this.rawElements.forEach(e=>{const t=String(e);if(t.indexOf("-")!=-1){const[s,i,...u]=t.split("-"),a=new r(s,!1),l=new r(i,!1);this.nombres.push(a);for(let h=a.intValue+1;h<l.intValue;h++){const f=new r(String(h),!0);this.nombres.push(f)}this.nombres.push(l)}else this.nombres.push(new r(t,!1))})}beginsConsecutiveTriplet(e){if(this.nombres.length-3<e)return!1;const t=this.nombres[e],s=this.nombres[e+1],i=this.nombres[e+2];return!!(t.intValue+1==s.intValue&&t.intValue+2==i.intValue&&String(s.display.text).match(/^\d+$/))}order(){const e=this.nombres;this.nombres=e.filter(t=>t.display.text).sort((t,s)=>t.intValue-s.intValue)}unify(){const e=this.nombres,t=[];this.nombres=e.filter(s=>t.includes(s.display.text)?!1:(t.push(s.display.text),!0))}hyphenate(){if(this.nombres.length<3)return;const e=[];e.push({item:this.nombres[0],isHyphen:!1});for(let t=0;t<this.nombres.length-2;t++){const s=this.nombres[t+1];e.push({item:s,isHyphen:this.beginsConsecutiveTriplet(t)})}return e.push({item:this.nombres.slice(-1)[0],isHyphen:!1}),this.nombres=e.map(t=>(t.isHyphen&&(t.item.display.text="–"),t.item)),this.nombres}formatAll(){return this.order(),this.unify(),this.hyphenate(),this.nombres.map(e=>e.display.text).join(", ").replace(/, (\u2013, )+/g,"–")}}export{c as A,m as E};
