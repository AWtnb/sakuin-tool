import{S as V}from"./SectionEnd-4fc2ed61.js";import{_ as k,o as i,a as u,F as y,g as w,e as r,t as f,h as j,f as v,b as p,r as B,i as b,j as _,w as g,x,u as $,s as I,l as E,p as M,d as T}from"./index-bb2d1afe.js";import{S as A,a as C}from"./CopyButton-405adcdd.js";import{E as P,A as L,R as F}from"./ResultBox-2c9baf72.js";const R={name:"PossibleList",props:{children:Array}},W={key:0},q={key:1};function z(l,e,t,n,a,d){return i(),u("ul",null,[(i(!0),u(y,null,w(t.children,(s,o)=>(i(),u("li",{key:o},[r("span",null,[s.pre.length?(i(),u("mark",W,f(s.pre),1)):j("",!0),v(f(s.rest),1),s.post.length?(i(),u("mark",q,f(s.post),1)):j("",!0)])]))),128))])}const H=k(R,[["render",z]]),O={name:"FoundTable",components:{PossibleList:H},props:{found:Array}},G={key:0},J={class:"limit-height"},K=r("thead",null,[r("tr",null,[r("th",null,"項目"),r("th",null,"子項目候補")])],-1);function Q(l,e,t,n,a,d){const s=B("PossibleList");return t.found.length?(i(),u("div",G,[r("div",J,[r("table",null,[K,r("tbody",null,[(i(!0),u(y,null,w(t.found,(o,N)=>(i(),u("tr",{key:N},[r("td",null,f(o.parent),1),r("td",null,[p(s,{children:o.children},null,8,["children"])])]))),128))])])])])):j("",!0)}const X=k(O,[["render",Q]]);class Y{constructor(e,t){this.name=e,this.mode=t,this.modified=!1,this.pre="",this.post="",this.rest=""}search(e){(this.mode=="all"||this.mode=="head")&&this.name.startsWith(e)&&(this.pre=e,this.modified=!0),this.rest=this.name.substring(this.pre.length),(this.mode=="all"||this.mode=="tail")&&this.name.endsWith(e)&&(this.post=e,this.modified=!0),this.rest=this.rest.substring(0,this.rest.length-this.post.length)}}class Z{constructor(e,t="tail"){this.mode=t,this.mainEntries=e.filter(n=>String(n).trim()).map(n=>new P(n)).filter(n=>!n.isReference&&!n.isChild).map(n=>({name:n.name,basename:n.basename}))}findPossibles(){return this.mainEntries.map(e=>{const t=e.basename,n=this.mainEntries.filter(a=>a.basename!=t).map(a=>{const d=new Y(a.basename,this.mode);return d.search(t),d.modified?d:null}).filter(Boolean);return{parent:e.name,children:n}}).filter(e=>e.children.length>0).sort((e,t)=>t.parent.length-e.parent.length)}}const ee=r("h2",null,"子項目候補をチェックする",-1),te={__name:"CheckChild",setup(l){const e=b(""),t=b("all"),n=_(()=>C(e.value)),a=_(()=>new Z(n.value,t.value).findPossibles());return(d,s)=>(i(),u(y,null,[ee,p(A,{onUpdateContent:s[0]||(s[0]=o=>e.value=o.content)}),r("div",null,[r("label",null,[g(r("input",{type:"radio",value:"tail","onUpdate:modelValue":s[1]||(s[1]=o=>t.value=o)},null,512),[[x,t.value]]),v("末尾一致")]),r("label",null,[g(r("input",{type:"radio",value:"head","onUpdate:modelValue":s[2]||(s[2]=o=>t.value=o)},null,512),[[x,t.value]]),v("先頭一致")]),r("label",null,[g(r("input",{type:"radio",value:"all","onUpdate:modelValue":s[3]||(s[3]=o=>t.value=o)},null,512),[[x,t.value]]),v("両方")])]),p(X,{found:$(a)},null,8,["found"])],64))}};const ne={name:"AddressDiff",props:{diffDetails:{type:Array,require:!0}}},se={key:0};function re(l,e,t,n,a,d){return i(!0),u(y,null,w(t.diffDetails,(s,o)=>(i(),u("span",{key:o},[r("del",null,f(s.before),1),r("span",{style:I({color:s.color})},f(s.text),5),s.isEnd?j("",!0):(i(),u("span",se,", "))]))),128)}const le=k(ne,[["render",re],["__scopeId","data-v-fe5cb16f"]]),S=l=>isNaN(Number(l))?l.replace(/[^\d]/g,""):l,ae=(l,e)=>{const t=l.map((n,a)=>{const d=e[a],s=a==l.length-1;return S(n)!=S(d)?{text:d,before:n,color:"#ff0080",isEnd:s}:{text:n,before:"",color:"#333",isEnd:s}});return{modified:t.some(n=>n.before.length>0),detail:t}};class oe{constructor(e,t,n){this.start=e,this.end=t,this.delta=n}adjust(e){return Number(this.start)<=e.intValue&&e.intValue<=Number(this.end)?e.adjust(this.delta):e.text}}class ie{constructor(e,t,n,a){this.lines=e,this.adjuster=new oe(t,n,a)}adjust(){return this.lines.map(e=>{const t=new P(e),n=new L(t.address).rawElements,a=n.map(d=>{const s=new L(d).nombres;return s.length>1?this.adjuster.adjust(s[0])+"–"+this.adjuster.adjust(s.at(-1)):this.adjuster.adjust(s[0])});return{name:t.name,newNombres:a,comparison:ae(n,a)}})}}const ue=l=>(M("data-v-27f0decf"),l=l(),T(),l),de=ue(()=>r("h2",null,"ノンブル加算減算",-1)),ce={class:"config"},me={key:0},pe={__name:"PlusMinus",setup(l){const e=b(""),t=b(1),n=b(999),a=b(1),d=_(()=>C(e.value)),s=_(()=>new ie(d.value,t.value,n.value,a.value).adjust()),o=_(()=>s.value.filter(c=>c.comparison.modified).map(c=>({name:c.name,detail:c.comparison.detail}))),N=_(()=>e.value.length<1?"":o.value.length?o.value.length+"件の変更があります。":"修正箇所はありません。"),U=_(()=>s.value.map(c=>c.newNombres.length?`${c.name}　　${c.newNombres.join(", ")}`:c.name).join(`
`));return(c,h)=>(i(),u(y,null,[de,r("ul",ce,[r("li",null,[v("開始 "),g(r("input",{type:"number",min:"1","onUpdate:modelValue":h[0]||(h[0]=m=>t.value=m)},null,512),[[E,t.value]])]),r("li",null,[v("終了 "),g(r("input",{type:"number",min:"1","onUpdate:modelValue":h[1]||(h[1]=m=>n.value=m)},null,512),[[E,n.value]])]),r("li",null,[v("増分 "),g(r("input",{type:"number","onUpdate:modelValue":h[2]||(h[2]=m=>a.value=m)},null,512),[[E,a.value]])])]),p(A,{onUpdateContent:h[3]||(h[3]=m=>e.value=m.content)}),p(F,{result:$(U)},null,8,["result"]),r("div",null,[r("h4",null,f($(N)),1),$(o).length?(i(),u("ul",me,[(i(!0),u(y,null,w($(o),(m,D)=>(i(),u("li",{key:D},[r("span",null,f(m.name)+"　　",1),p(le,{"diff-details":m.detail},null,8,["diff-details"])]))),128))])):j("",!0)])],64))}},he=k(pe,[["__scopeId","data-v-27f0decf"]]),fe={class:"adjust"},_e=r("h1",null,"微調整",-1),$e={__name:"AdjustView",setup(l){return(e,t)=>(i(),u("div",fe,[_e,p(te),p(V),p(he),p(V)]))}};export{$e as default};
