import{S as B}from"./SectionEnd-a32b3d29.js";import{_ as I,o as d,a as h,b as t,F as k,g as P,t as y,d as f,h as V,p as E,f as A,c as M,i as x,j as S,u as p,k as w,v as T,l as R,n as U,m as D,e as $,q as j,r as q,s as K,x as L}from"./index-c2f359e9.js";import{C as F,S as H,a as O,t as z}from"./SimpleTextarea-52f9e5e9.js";import{B as W}from"./BeforeAfter-2c1e115c.js";const G="/sakuin-tool/assets/template-image-52f629d1.png";const N=s=>(E("data-v-c9afd60e"),s=s(),A(),s),J={key:0},Q={class:"limit-height"},X=N(()=>t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1)),Y={class:"meta-info"},Z={class:"meta-info"},tt=N(()=>t("td",null,null,-1)),et=N(()=>t("td",null,null,-1)),nt={__name:"TemplateTable",props:{rows:Array,resultStr:String},setup(s){return(_,l)=>s.rows.length?(d(),h("div",J,[t("div",Q,[t("table",null,[X,t("tbody",null,[(d(!0),h(k,null,P(s.rows,(a,c)=>(d(),h("tr",{key:c},[t("td",Y,y(a.id),1),t("td",Z,y(a.idx),1),t("td",null,y(a.nombre),1),tt,et]))),128))])])]),f(F,{copyStr:s.resultStr},null,8,["copyStr"])])):V("",!0)}},ot=I(nt,[["__scopeId","data-v-c9afd60e"]]),st="/sakuin-tool/assets/generate-index-28f0eaa2.png",lt="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",at={name:"ExcelSetting"},rt=M('<summary>TIPS：条件付き書式の設定</summary><img src="'+st+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+lt+'">',5),ut=[rt];function ct(s,_,l,a,c,v){return d(),h("details",null,ut)}const it=I(at,[["render",ct]]);const dt={class:"nombre"},_t={class:"ui"},mt=["onKeyup","tabindex"],pt={__name:"CountRow",props:{maxRow:Number,nombreIdx:Number},emits:["updateCounter"],setup(s,{emit:_}){const l=s,a=1e3,c=x(()=>Number(l.nombreIdx)+1),v=x(()=>Number(l.nombreIdx)+a),m=S(0),r=()=>{_("updateCounter",{nombre:c.value,counter:m.value})},n=i=>{const b=Number(i.target.getAttribute("tabindex"))+1;if(a+l.maxRow<=b)return;const g=document.querySelector(`[tabindex="${b}"]`);g&&(g.focus(),g.select())},e=i=>{const b=Number(i.target.getAttribute("tabindex"))-1;if(b<a)return;const g=document.querySelector(`[tabindex="${b}"]`);g&&(g.focus(),g.select())},o=S(!1);return(i,u)=>(d(),h("tr",{class:U({focused:o.value})},[t("td",dt,y(p(c)),1),t("td",_t,[w(t("input",{type:"number",min:"0","onUpdate:modelValue":u[0]||(u[0]=b=>m.value=b),onInput:r,onKeyup:[R(n,["right"]),R(e,["left"])],tabindex:p(v),onFocus:u[1]||(u[1]=b=>o.value=!0),onBlur:u[2]||(u[2]=b=>o.value=!1)},null,40,mt),[[T,m.value]])])],2))}},ht=I(pt,[["__scopeId","data-v-200605d7"]]);const C=s=>(E("data-v-41aec5c1"),s=s(),A(),s),ft=C(()=>t("h2",null,"索引拾いのテンプレート生成",-1)),bt=["src"],vt=C(()=>t("p",null,[$("ゲラ上にマーカーを引いた項目を Excel に記入するためのテンプレートを作ります。"),t("br"),$("先にカウントしておくことで、入力作業に集中することができます。")],-1)),xt=["disabled"],$t=["disabled"],gt={class:"wrapper"},yt=C(()=>t("table",{class:"only-header"},[t("thead",null,[t("tr",null,[t("th",null,"ページ"),$(),t("th",null,"個数")])])],-1)),St={class:"main-content"},kt=C(()=>t("ul",null,[t("li",null,"上下キーでカウントを増減させられます"),t("li",null,"左右キーで入力欄を移動できます"),t("li",null,"見よ項目があれば見よ先項目とのペアで1つとカウントします")],-1)),It={__name:"Pickup",setup(s){const _=S(1),l=S(250),a=x(()=>{const n=[];for(let e=_.value-1;e<l.value;e++)n.push(e);return n}),c=D(new Map),v=n=>{c.set(n.nombre,n.counter)},m=x(()=>{const n=[];let e=0;return Array.from(c.keys()).filter(o=>c.get(o)>0).forEach((o,i)=>{for(let u=0;u<c.get(o);u++)e+=1,n.push({id:e,idx:i+1,nombre:o})}),n}),r=x(()=>[["ID","index","ページ","項目","見よ先"].join("	")].concat(m.value.map(o=>`${o.id}	${o.idx}	${o.nombre}		`)).join(`
`));return(n,e)=>(d(),h(k,null,[ft,t("p",null,[t("img",{src:p(G)},null,8,bt)]),vt,t("label",null,[$("開始ページ"),w(t("input",{type:"number",min:"1","onUpdate:modelValue":e[0]||(e[0]=o=>_.value=o),disabled:p(m).length},null,8,xt),[[T,_.value]])]),t("label",null,[$("終了ページ"),w(t("input",{type:"number",min:"1","onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),disabled:p(m).length},null,8,$t),[[T,l.value]])]),t("div",gt,[yt,t("div",St,[t("table",null,[t("tbody",null,[(d(!0),h(k,null,P(p(a),(o,i)=>(d(),j(ht,{nombreIdx:o,maxRow:l.value,key:i,onUpdateCounter:v},null,8,["nombreIdx","maxRow"]))),128))])])])]),kt,f(ot,{rows:p(m),resultStr:p(r)},null,8,["rows","resultStr"]),f(it)],64))}},wt=I(It,[["__scopeId","data-v-41aec5c1"]]),Ct="/sakuin-tool/assets/before-f6e4167d.png",Tt="/sakuin-tool/assets/after-8fa046e6.png",Pt={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:F}},Nt={key:0},Bt={class:"limit-height"},Rt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function Vt(s,_,l,a,c,v){const m=q("CopyButton");return l.lines.length?(d(),h("div",Nt,[t("div",Bt,[t("table",null,[Rt,t("tbody",null,[(d(!0),h(k,null,P(l.lines,(r,n)=>(d(),h("tr",{key:n},[t("td",null,y(r.name),1),t("td",null,y(r.nombre),1)]))),128))])])]),f(m,{copyStr:l.resultStr},null,8,["copyStr"])])):V("",!0)}const Et=I(Pt,[["render",Vt]]),At=t("h2",null,"入力済テンプレートの整形",-1),Ft=t("h3",null,"整形内容",-1),Mt=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),$("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),$("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),Ut={__name:"Preformat",setup(s){const _=r=>{const n=[];return r.filter(e=>e.trim()).map(e=>e.split("	")).filter(e=>e.length>2).map(e=>e.map(o=>o.trim())).forEach(e=>{const o=z(e[0]),i=e[1],u=e[2];if(!(o.length<1||i.length<1)){if(u.length<1){n.push({nombre:o,name:i});return}n.push({nombre:"",name:`${i}　→${u}`}),n.push({nombre:o,name:`${u}（${i}）`})}}),n},l=S(""),a=S(!0),c=x(()=>{const r=O(l.value);return a.value?r.slice(1):r}),v=x(()=>_(c.value)),m=x(()=>v.value.map(r=>`${r.name}	${r.nombre}`).join(`
`));return(r,n)=>(d(),h(k,null,[At,f(W,{beforePath:p(Ct),afterPath:p(Tt)},null,8,["beforePath","afterPath"]),Ft,Mt,t("label",null,[w(t("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e)},null,512),[[K,a.value]]),$("先頭行をスキップする")]),f(H,{onUpdateContent:n[1]||(n[1]=e=>l.value=e.content)}),f(Et,{lines:p(v),resultStr:p(m)},null,8,["lines","resultStr"])],64))}},Dt={class:"pickup"},jt=t("h1",null,"事前準備",-1),Ot={__name:"PrepareView",emits:["updateState"],setup(s,{emit:_}){return L(()=>{_("updateState",{isRevision:!1})}),(l,a)=>(d(),h("div",Dt,[jt,f(wt),f(B),f(Ut),f(B)]))}};export{Ot as default};
