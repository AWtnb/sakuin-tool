import{S as j}from"./SectionEnd-07fd441b.js";import{_ as P,r as b,o as c,a as i,e as t,F as B,g as T,t as k,b as u,h as I,c as H,i as h,j as C,w as V,v as E,f as x,u as w}from"./index-294494d2.js";import{P as N,t as D,a as F}from"./PasteBox-39580ba4.js";import{C as L}from"./CopyButton-9d509e71.js";const A="/sakuin-tool/assets/newtemplate-67fdefb0.png",M={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:L}},O={key:0},R={class:"limit-height"},G=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),W=t("td",null,null,-1),q=t("td",null,null,-1);function z($,_,n,s,a,m){const d=b("CopyButton");return n.lines.length?(c(),i("div",O,[t("div",R,[t("table",null,[G,t("tbody",null,[(c(!0),i(B,null,T(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,k(r.id),1),t("td",null,k(r.pageIdx),1),t("td",null,k(r.page),1),W,q]))),128))])])]),u(d,{copyStr:n.resultStr},null,8,["copyStr"])])):I("",!0)}const J=P(M,[["render",z]]),K="/sakuin-tool/assets/generate-index-28f0eaa2.png",Q="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",X={name:"ExcelSetting"},Y=H('<summary>TIPS：条件付き書式の設定</summary><img src="'+K+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+Q+'">',5),Z=[Y];function tt($,_,n,s,a,m){return c(),i("details",null,Z)}const et=P(X,[["render",tt]]),nt=t("h2",null,"索引拾いのテンプレート生成",-1),ot=t("div",null,[t("img",{src:A,alt:""})],-1),lt=t("p",null,[t("code",null,"個数"),x("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1),st={__name:"Pickup",setup($){const _=o=>{const e=[];let l=0;return o.filter(g=>g).forEach(g=>{const[f,v,...U]=g.split("	"),S=D(v);if(Number(S)>0){l+=1;for(let y=0;y<Number(S);y++)e.push({id:String(e.length+1),pageIdx:String(l),page:String(f)})}}),e},n=h(""),s=h([]),a=h(!0),m=C(()=>{const o=F(n.value);return a.value?o.slice(1):o}),d=C(()=>["ID	index	ページ	項目	見よ先"].concat(s.value.map(e=>`${e.id}	${e.pageIdx}	${e.page}		`)).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(B,null,[nt,t("label",null,[V(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l)},null,512),[[E,a.value]]),x("先頭行をスキップする")]),u(N,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),u(J,{lines:s.value,resultStr:w(d)},null,8,["lines","resultStr"]),ot,lt,u(et)],64))}},rt="/sakuin-tool/assets/preformat-9f6a2373.png",at={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:L}},ut={key:0},ct={class:"limit-height"},it=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function dt($,_,n,s,a,m){const d=b("CopyButton");return n.lines.length?(c(),i("div",ut,[t("div",ct,[t("table",null,[it,t("tbody",null,[(c(!0),i(B,null,T(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,k(r.name),1),t("td",null,k(r.nombre),1)]))),128))])])]),u(d,{copyStr:n.resultStr},null,8,["copyStr"])])):I("",!0)}const pt=P(at,[["render",dt]]),_t=t("h2",null,"入力済テンプレートの整形",-1),mt=t("h3",null,"整形内容",-1),ft=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),x("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),x("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),ht=t("div",null,[t("img",{src:rt,alt:""})],-1),$t={__name:"Preformat",setup($){const _=o=>{const e=[];return o.filter(l=>l.trim()).forEach(l=>{const[g,f,v,...U]=l.split("	").map(y=>y.trim()),S=String(D(g));String(v).length>0?(e.push({nombre:"",name:`${f}　→${v}`}),e.push({nombre:S,name:`${v}（${f}）`})):String(f).length>0&&e.push({nombre:S,name:f})}),e},n=h(""),s=h([]),a=h(!0),m=C(()=>{const o=F(n.value);return a.value?o.slice(1):o}),d=C(()=>s.value.map(o=>`${o.name}	${o.nombre}`).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(B,null,[_t,t("label",null,[V(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l)},null,512),[[E,a.value]]),x("先頭行をスキップする")]),u(N,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),mt,ft,u(pt,{lines:s.value,resultStr:w(d)},null,8,["lines","resultStr"]),ht],64))}},gt={name:"PrepareView",components:{SectionEnd:j,Pickup:st,Preformat:$t}},vt={class:"pickup"},St=t("h1",null,"事前準備",-1);function bt($,_,n,s,a,m){const d=b("Pickup"),r=b("SectionEnd"),p=b("Preformat");return c(),i("div",vt,[St,u(d),u(r),u(p),u(r)])}const Pt=P(gt,[["render",bt]]);export{Pt as default};
