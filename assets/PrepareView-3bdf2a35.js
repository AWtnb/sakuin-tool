import{S as B}from"./SectionEnd-4fc2ed61.js";import{_ as x,o as a,a as u,e as t,F as y,g as C,t as S,b as s,h as I,r as V,c as j,i as v,j as g,u as p,w as E,v as N,f as $}from"./index-bb2d1afe.js";import{C as w,S as D,a as F,t as L}from"./CopyButton-405adcdd.js";import{B as U}from"./BeforeAfter-4cb0b54e.js";const A="/sakuin-tool/assets/before-d3cd42c2.png",H="/sakuin-tool/assets/after-2f5032e0.png",M={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:w}},O={key:0},R={class:"limit-height"},W=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),q=t("td",null,null,-1),z=t("td",null,null,-1);function G(b,_,o,r,f,m){const i=V("CopyButton");return o.lines.length?(a(),u("div",O,[t("div",R,[t("table",null,[W,t("tbody",null,[(a(!0),u(y,null,C(o.lines,(n,e)=>(a(),u("tr",{key:e},[t("td",null,S(n.id),1),t("td",null,S(n.pageIdx),1),t("td",null,S(n.page),1),q,z]))),128))])])]),s(i,{copyStr:o.resultStr},null,8,["copyStr"])])):I("",!0)}const J=x(M,[["render",G]]),K="/sakuin-tool/assets/generate-index-28f0eaa2.png",Q="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",X={name:"ExcelSetting"},Y=j('<summary>TIPS：条件付き書式の設定</summary><img src="'+K+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+Q+'">',5),Z=[Y];function tt(b,_,o,r,f,m){return a(),u("details",null,Z)}const et=x(X,[["render",tt]]),nt=t("h2",null,"索引拾いのテンプレート生成",-1),lt=t("p",null,[$("※"),t("code",null,"個数"),$("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1),ot={__name:"Pickup",setup(b){const _=n=>{const e=[];let l=0;return n.filter(c=>c).forEach(c=>{const d=c.split("	");if(d.length<2)return;const h=d[0].trim(),k=d[1].trim();if(h.length<1||k.length<1)return;const P=Number(L(k));if(P>0){l+=1;for(let T=0;T<P;T++)e.push({id:String(e.length+1),pageIdx:String(l),page:String(h)})}}),e},o=v(""),r=v(!0),f=g(()=>{const n=F(o.value);return r.value?n.slice(1):n}),m=g(()=>["ID	index	ページ	項目	見よ先"].concat(i.value.map(e=>`${e.id}	${e.pageIdx}	${e.page}		`)).join(`
`)),i=g(()=>_(f.value));return(n,e)=>(a(),u(y,null,[nt,s(U,{beforePath:p(A),afterPath:p(H)},null,8,["beforePath","afterPath"]),lt,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l)},null,512),[[N,r.value]]),$("先頭行をスキップする")]),s(D,{onUpdateContent:e[1]||(e[1]=l=>o.value=l.content)}),s(J,{lines:p(i),resultStr:p(m)},null,8,["lines","resultStr"]),s(et)],64))}},st="/sakuin-tool/assets/before-f6e4167d.png",rt="/sakuin-tool/assets/after-8fa046e6.png",at={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:w}},ut={key:0},ct={class:"limit-height"},it=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function dt(b,_,o,r,f,m){const i=V("CopyButton");return o.lines.length?(a(),u("div",ut,[t("div",ct,[t("table",null,[it,t("tbody",null,[(a(!0),u(y,null,C(o.lines,(n,e)=>(a(),u("tr",{key:e},[t("td",null,S(n.name),1),t("td",null,S(n.nombre),1)]))),128))])])]),s(i,{copyStr:o.resultStr},null,8,["copyStr"])])):I("",!0)}const pt=x(at,[["render",dt]]),_t=t("h2",null,"入力済テンプレートの整形",-1),mt=t("h3",null,"整形内容",-1),ft=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),$("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),$("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),ht={__name:"Preformat",setup(b){const _=n=>{const e=[];return n.filter(l=>l.trim()).map(l=>l.split("	")).filter(l=>l.length>2).map(l=>l.map(c=>c.trim())).forEach(l=>{const c=L(l[0]),d=l[1],h=l[2];if(!(c.length<1||d.length<1)){if(h.length<1){e.push({nombre:c,name:d});return}e.push({nombre:"",name:`${d}　→${h}`}),e.push({nombre:c,name:`${h}（${d}）`})}}),e},o=v(""),r=v(!0),f=g(()=>{const n=F(o.value);return r.value?n.slice(1):n}),m=g(()=>_(f.value)),i=g(()=>m.value.map(n=>`${n.name}	${n.nombre}`).join(`
`));return(n,e)=>(a(),u(y,null,[_t,s(U,{beforePath:p(st),afterPath:p(rt)},null,8,["beforePath","afterPath"]),mt,ft,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>r.value=l)},null,512),[[N,r.value]]),$("先頭行をスキップする")]),s(D,{onUpdateContent:e[1]||(e[1]=l=>o.value=l.content)}),s(pt,{lines:p(m),resultStr:p(i)},null,8,["lines","resultStr"])],64))}},gt={class:"pickup"},$t=t("h1",null,"事前準備",-1),xt={__name:"PrepareView",setup(b){return(_,o)=>(a(),u("div",gt,[$t,s(ot),s(B),s(ht),s(B)]))}};export{xt as default};
