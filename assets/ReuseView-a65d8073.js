import{S as $}from"./SectionEnd-077b90ed.js";import{S as x,a as L,C as R}from"./SimpleTextarea-0c5c797f.js";import{R as C,E as w,A as T}from"./entry-1bda0a3d.js";import{_ as P,j as k,i as c,o as m,a as p,b as o,u as d,e as a,t as S,F as b,g as A,h as B,c as U,r as V}from"./index-000a48d4.js";import{B as F}from"./BeforeAfter-991b080a.js";const j=f=>{const t=String(f).match(/\d[\d,\u2013]*$/);return t?t[0]:""},O=["‐","‑","‒","–","—","―","－","─","-"],H=f=>{let t=f.split(",")[0];return t=t.replace(/\d+$/,""),O.includes(t.at(-1))&&t.at(-2).match(/\d/)&&(t=t.replace(/.$/,""),t=t.replace(/\d+$/,"")),t};class E{constructor(t){this.valiation=O,this.rawStr=t}format(t="–"){let e=this.rawStr;return this.valiation.forEach(l=>{e=e.replaceAll(l,"-")}),e.replace(/\u002d+/g,t)}getHeaderLen(){let t=0;for(let e=0;e<this.rawStr.length&&this.valiation.includes(this.rawStr[e]);e++)t+=1;return t}getTrailerLen(){let t=0;for(let e=this.rawStr.length-1;0<=e&&this.valiation.includes(this.rawStr[e]);e--)t+=1;return t}formatChildEntry(){const t=this.getHeaderLen(),e=t>0?"――":"",l=this.getTrailerLen(),h=l>0?"――":"";return e+this.rawStr.slice(t,this.rawStr.length-l)+h}}class N{constructor(t){this.prefix=t.startsWith(" ")||t.startsWith("　")?"　":"";const e=String(t).replace(/\uff0c/g,",").replace(/\s+/g,""),l=j(new E(e).format());if(l.length>0){this.address=l.replaceAll(",",", "),this.name=H(e);return}if(this.address="",e.indexOf("→")!=-1){this.name=e.replace(/→/,"　→");return}this.name=e}getFormattedLine(){const t=this.prefix+new E(this.name).formatChildEntry();return this.address.length>0?t+"　　"+this.address:t}}const W=U("<h2 data-v-580074df>ゲラから抽出した索引データの整形</h2><ul data-v-580074df><li data-v-580074df><strong data-v-580074df>ゲラからテキストを抽出すると長い行が折り返されて改行になっていることがあります。</strong><ul data-v-580074df><li data-v-580074df>そうした箇所は先に手動で整形してください。</li></ul></li><li data-v-580074df>見よ項目の矢印の前のアキを1倍モノに統一します。</li><li data-v-580074df>連続するノンブルを示すダーシの種類を<code data-v-580074df>–</code>（enダーシ）に統一します。</li><li data-v-580074df>子項目のダーシの種類を<code data-v-580074df>――</code>（2倍ダーシ）に統一します。</li></ul>",2),I={key:0},D={class:"detail"},q={class:"original"},z={class:"formatted"},G={__name:"FormatOld",setup(f){const t=n=>n.map(s=>String(s).trimEnd().replace(/\t/,"　　")).map(s=>({formatted:new N(s).getFormattedLine(),original:s})),e=k(""),l=c(()=>L(e.value)),h=c(()=>t(l.value)),g=c(()=>h.value.map(n=>n.formatted).join(`
`)),u=c(()=>h.value.filter(n=>n.formatted!=n.original)),r=c(()=>e.value.length<1?"":u.value.length>0?u.value.length+"箇所を修正しました！":"問題のある箇所は見当たりませんでした！");return(n,s)=>(m(),p(b,null,[W,o(x,{onUpdateContent:s[0]||(s[0]=i=>e.value=i.content)}),o(C,{result:d(g)},null,8,["result"]),a("div",null,[a("h4",null,S(d(r)),1),d(u).length?(m(),p("ol",I,[(m(!0),p(b,null,A(d(u),(i,_)=>(m(),p("li",{key:_},[a("ul",D,[a("li",q,S(i.original),1),a("li",z,S(i.formatted),1)])]))),128))])):B("",!0)])],64))}},J=P(G,[["__scopeId","data-v-580074df"]]),K="/sakuin-tool/assets/before-553b588b.png",M="/sakuin-tool/assets/after-cef2c7b2.png",Q=a("h2",null,"子項目の復元",-1),X={__name:"ResolveChild",setup(f){const t=r=>{if(r.length<1)return[];const n=[],s=[];n.push(r[0]),s.push(new w(r[0]).basename);for(let i=1;i<r.length;i++){const _=new w(r[i]),v=_.basename;if(v.startsWith("――")){const y=s.at(-1)+v.substring(2);n.push(y+"　　"+_.address)}else if(v.endsWith("――")){const y=v.substring(0,v.length-2)+s.at(-1);n.push(y+"　　"+_.address)}else n.push(_.rawStr),s.push(v)}return n},e=k(""),l=c(()=>L(e.value)),h=c(()=>l.value.map(r=>r.trim()).filter(r=>r.length)),g=c(()=>t(h.value)),u=c(()=>g.value.join(`
`));return(r,n)=>(m(),p(b,null,[Q,o(F,{beforePath:d(K),afterPath:d(M)},null,8,["beforePath","afterPath"]),o(x,{onUpdateContent:n[0]||(n[0]=s=>e.value=s.content)}),o(C,{result:d(u)},null,8,["result"])],64))}},Y="/sakuin-tool/assets/before-e62df1a7.png",Z="/sakuin-tool/assets/after-49f03dfc.png",tt={name:"UngroupedTable",props:{lines:Array,resultStr:String},components:{CopyButton:R}},et={key:0},nt={class:"limit-height"},rt=a("thead",null,[a("tr",null,[a("th",null,"項目"),a("th",null,"ノンブル")])],-1);function st(f,t,e,l,h,g){const u=V("CopyButton");return e.lines.length?(m(),p("div",et,[a("div",nt,[a("table",null,[rt,a("tbody",null,[(m(!0),p(b,null,A(e.lines,(r,n)=>(m(),p("tr",{key:n},[a("td",null,S(r.name),1),a("td",null,S(r.nombre),1)]))),128))])])]),o(u,{copyStr:e.resultStr},null,8,["copyStr"])])):B("",!0)}const at=P(tt,[["render",st]]),ot=a("h2",null,"名開き",-1),lt=a("p",null,"※項目とノンブルが Excel 上で2列に分かれていても大丈夫です。",-1),ut={__name:"Ungroup",setup(f){const t=u=>{const r=[];return u.filter(n=>n.trim()).map(n=>n.replace("	","　　")).forEach(n=>{const s=new w(n);if(s.isReference){r.push({name:s.name,nombre:""});return}new T(s.address).nombres.forEach(i=>{const _=i.hyphenated?String(i.intValue):i.getText();r.push({name:s.name,nombre:_})})}),r},e=k(""),l=c(()=>L(e.value)),h=c(()=>t(l.value)),g=c(()=>h.value.map(u=>`${u.name}	${u.nombre}`.trimEnd()).join(`
`));return(u,r)=>(m(),p(b,null,[ot,o(F,{beforePath:d(Y),afterPath:d(Z)},null,8,["beforePath","afterPath"]),lt,o(x,{onUpdateContent:r[0]||(r[0]=n=>e.value=n.content)}),o(at,{lines:d(h),resultStr:d(g)},null,8,["lines","resultStr"])],64))}},it={class:"reuse"},ct=a("h1",null,"旧版索引の再利用",-1),_t={__name:"ReuseView",setup(f){return(t,e)=>(m(),p("div",it,[ct,o(J),o($),o(X),o($),o(ut),o($)]))}};export{_t as default};
