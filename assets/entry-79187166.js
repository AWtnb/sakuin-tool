class h{constructor(e,s=!1){this.rawStr=e.trim(),this.hyphenated=s,this.intValue=Number(this.rawStr.replace(/[^\d]/g,""))}getPrefix(){const e=this.rawStr;return e.length&&isNaN(e.at(0))?e.split(/\d+/).at(0):""}getSuffix(){const e=this.rawStr;return e.length&&isNaN(e.at(-1))?e.split(/\d+/).at(-1):""}adjust(e){this.intValue+=Number(e)}getText(){return this.hyphenated?"–":this.intValue===0?this.rawStr:this.getPrefix()+String(this.intValue)+this.getSuffix()}getId(){return`text:${this.getText()}-value:${this.intValue}`}}class l{constructor(e){this.nombres=e}order(){const e=this.nombres;this.nombres=e.filter(s=>s.getText()).sort((s,t)=>s.intValue-t.intValue)}unify(){const e=this.nombres,s=[];this.nombres=e.filter(t=>{const r=t.getId();return s.includes(r)?!1:(s.push(r),!0)})}isConsecutiveTriplet(e){if(this.nombres.length-3<e)return!1;const s=this.nombres[e],t=this.nombres[e+1],r=this.nombres[e+2];return s.intValue+1==t.intValue&&s.intValue+2==r.intValue&&t.getPrefix().length<1&&t.getSuffix().length<1}hyphenate(){if(!(this.nombres.length<3)){this.nombres[0].hyphenated=!1;for(let e=0;e<this.nombres.length-2;e++)this.nombres[e+1].hyphenated=this.isConsecutiveTriplet(e);this.nombres.at(-1).hyphenated=!1}}getText(){return this.nombres.map(e=>e.getText()).join(", ").replace(/, (\u2013, )+/g,"–")}}class f{constructor(e){this.nombres=[],e.replace(/\s/g,"").replace(/\uff0c/g,",").replace(/[\u002d\u2010\u2011\u2012\u2013\u2014\uFF0D]+/g,"-").replace(/[\uff21-\uff3a\uff41-\uff5a\uff10-\uff19]/g,function(t){return String.fromCharCode(t.charCodeAt(0)-65248)}).split(",").map(t=>t.trim()).filter(Boolean).forEach(t=>{if(t.indexOf("-")!=-1){this.setRangedNombre(t);return}this.nombres.push(new h(t,!1))})}setRangedNombre(e){const[s,t,...r]=e.split("-");if(s.length&&t.length){const a=new h(s,!1),n=new h(t,!1);this.nombres.push(a);for(let u=a.intValue+1;u<n.intValue;u++)this.nombres.push(new h(String(u),!0));this.nombres.push(n)}}formatAll(){const e=new l(this.nombres);return e.order(),e.unify(),e.hyphenate(),e.getText()}adjust(e,s,t){const r=this.nombres.map(n=>(e<=n.intValue&&n.intValue<=s&&e&&n.adjust(t),n));return new l(r).getText()}unsorted(){if(this.nombres.length<2)return!1;for(let e=0;e<this.nombres.length-1;e++)if(this.nombres[e].intValue>=this.nombres[e+1].intValue)return!0;return!1}unHyphened(){if(this.nombres.length<3)return!1;for(let e=0;e<this.nombres.length-2;e++){const s=this.nombres[e],t=this.nombres[e+1],r=this.nombres[e+2];if(s.intValue+1==t.intValue&&s.intValue+2==r.intValue&&!t.hyphenated)return!0}return!1}}class o{constructor(e){this.reg=new RegExp("(（.+?）|［.+?］|\\(.+?\\)|\\[.+?\\])$"),this.name=e}getBasename(){const e=this.name.replace(this.reg,"").trim();return this.getReferTo().length?e.split("→")[0].trim().replace(/\u3000{1,2}/,""):e.replace(/\u3000{1,2}/,"")}getRefBasename(){return this.name.split("→")[0].trim()}getSource(){const e=this.name.match(this.reg);return e?e[0].slice(1,-1).trim().replace(/\uff0c/g,",").split(",").map(t=>t.trim()).filter(Boolean):[]}getReferTo(){const e=this.name.split("→").filter(s=>s.trim().length>0);return e.length==2?e.at(-1).trim():""}}class m{constructor(e,s="　　"){this.rawStr=e,this.isChild=e.trim().length>0&&e.trimStart()!=e,this.separator=s,this.elems=this.rawStr.split(this.separator).filter(Boolean).map(r=>String(r)),this.name=this.getName();const t=new o(this.name);this.basename=t.getBasename(),this.address=this.getRightSide().trim(),this.getFullname=this.name+this.separator+this.address,this.backLink=t.getSource(),this.referTo=t.getReferTo(),this.isReference=this.referTo.length&&this.name.length&&this.address.length<1}getLeftSide(){return this.elems.length>=2?this.elems.length>2?this.elems.slice(0,-1).join(this.separator):this.elems[0]:this.elems.length==1?this.elems[0]:""}getName(){const e=this.getLeftSide().trim();return e.length<1?"":(this.isChild?"　":"")+e}getRightSide(){return this.elems.length>=2?this.elems.length>2?this.elems.at(-1):this.elems[1]:""}}export{f as A,m as E};
