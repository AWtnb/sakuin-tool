import{S as j}from"./SectionEnd-6e6708e7.js";import{a as x,S as M}from"./SimpleTextarea-d6252d0f.js";import{_ as S,j as w,o as u,a,b as t,k as L,s as V,e as g,z as U,h as m,i as p,u as _,d as o,w as f,F as v,g as $,t as b,p as q,f as N,m as D}from"./index-be9679df.js";import{R as C,_ as F}from"./referenceChecker-beb3851e.js";import{E as R,A as T}from"./entry-79187166.js";import{_ as H}from"./LineDiff-793d7432.js";const P={class:"area"},z={key:0},G={__name:"IgnorableArea",setup(c){const n=w(!1);return(l,e)=>(u(),a("div",P,[t("label",null,[L(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=r=>n.value=r)},null,512),[[V,n.value]]),g("無視する")]),n.value?m("",!0):(u(),a("div",z,[U(l.$slots,"default",{},void 0,!0)]))]))}},k=S(G,[["__scopeId","data-v-24f1f406"]]),O={key:0},J=t("h3",null,"見よ先の括弧書きが足りません：",-1),K=t("thead",null,[t("tr",null,[t("th",null,"見よ項目"),t("th",null,"必要な項目")])],-1),Q={__name:"FindMissingBackLink",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=p(()=>{const s=new C(l.result).findMissingBackLink();return n("checkFinished",{problem:"missingBackLink",count:s.length}),s});return(r,s)=>_(e).length?(u(),a("div",O,[J,o(k,null,{default:f(()=>[t("table",null,[K,t("tbody",null,[(u(!0),a(v,null,$(_(e),(i,d)=>(u(),a("tr",{key:d},[t("td",null,b(i.problem),1),t("td",null,b(i.require),1)]))),128))])])]),_:1})])):m("",!0)}},W={key:0},X=t("h3",null,"見よ項目のすぐ隣に見よ先項目があります：",-1),Y={__name:"FindAdjacent",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=p(()=>{const s=new C(l.result).findAdjacent();return n("checkFinished",{problem:"adjacent",count:s.length}),s});return(r,s)=>_(e).length?(u(),a("div",W,[X,o(k,null,{default:f(()=>[o(F,{arr:_(e)},null,8,["arr"])]),_:1})])):m("",!0)}},Z={key:0},ee=t("h3",null,"見よ項目が足りません：",-1),te=t("thead",null,[t("tr",null,[t("th",null,"括弧のある項目"),t("th",null,"必要な見よ項目")])],-1),ne={__name:"CheckMissingRef",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=p(()=>{const s=new C(l.result).findMissingRefs();return n("checkFinished",{problem:"missingRef",count:s.length}),s});return(r,s)=>_(e).length?(u(),a("div",Z,[ee,o(k,null,{default:f(()=>[t("table",null,[te,t("tbody",null,[(u(!0),a(v,null,$(_(e),(i,d)=>(u(),a("tr",{key:d},[t("td",null,b(i.problem),1),t("td",null,[o(F,{arr:i.require},null,8,["arr"])])]))),128))])])]),_:1})])):m("",!0)}},se=t("thead",null,[t("tr",null,[t("th",null,"重複項目")])],-1),I={__name:"DuplicateTable",props:{detailsArr:Array},setup(c){return(n,l)=>(u(),a("table",null,[se,t("tbody",null,[(u(!0),a(v,null,$(c.detailsArr,(e,r)=>(u(),a("tr",{key:r},[t("td",null,[o(F,{arr:e},null,8,["arr"])])]))),128))])]))}};class B{constructor(n){const l=x(n);this.entries=l.filter(e=>String(e).trim()).map(e=>new R(e)),this.refs=this.entries.filter(e=>e.isReference),this.nonRefs=this.entries.filter(e=>!e.isReference),this.mainEntries=this.nonRefs.filter(e=>!e.isChild)}getUngrouped(){const n=[];return this.mainEntries.forEach(e=>{const r=e.basename,s=this.mainEntries.filter(i=>i.basename==r).map(i=>i.rawStr);s.length!=1&&n.push(s)}),n.filter((e,r,s)=>r===s.findIndex(i=>i.join("")===e.join("")))}getConflicting(){return this.refs.map(n=>{const l=n.basename,e=this.mainEntries.filter(r=>r.basename==l);return e.length<1?null:[n.name].concat(e.map(r=>r.rawStr))}).filter(Boolean)}}const re={key:0},le=t("h3",null,"見よ項目が本項目として残っています：",-1),ce={__name:"CheckConflict",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=p(()=>{const s=new B(l.result).getConflicting();return n("checkFinished",{problem:"conflictReference",count:s.length}),s});return(r,s)=>_(e).length?(u(),a("div",re,[le,o(k,null,{default:f(()=>[o(I,{detailsArr:_(e)},null,8,["detailsArr"])]),_:1})])):m("",!0)}},oe={key:0},ie=t("h3",null,"名寄せが不十分です：",-1),ue={__name:"CheckUngrouped",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=p(()=>{const s=new B(l.result).getUngrouped();return n("checkFinished",{problem:"ungrouped",count:s.length}),s});return(r,s)=>_(e).length?(u(),a("div",oe,[ie,o(k,null,{default:f(()=>[o(I,{detailsArr:_(e)},null,8,["detailsArr"])]),_:1})])):m("",!0)}};const E=c=>(q("data-v-8d555cc8"),c=c(),N(),c),ae={key:0},de=E(()=>t("h3",null,"ノンブルに修正提案があります：",-1)),_e=E(()=>t("ul",{class:"note"},[t("li",null,[t("del",null,"青の箇所"),g("を削除して、"),t("ins",null,"赤の箇所"),g("を追記すると正しいノンブル形式になります。")]),t("li",null,[g("マウスを使って、"),t("del",null,"青の箇所"),g("を飛ばして文字選択できます（文字選択を無効化しています）。")])],-1)),he={__name:"CheckAddress",props:{result:String},emits:["checkFinished"],setup(c,{emit:n}){const l=c,e=s=>x(s).filter(d=>String(d).trim()).map(d=>{const h=new R(d),y=new T(h.address);if(y.unsorted()||y.unHyphened()){const A=h.name+h.separator;return{line:d,origial:A+h.address,formatted:A+y.formatAll()}}return null}).filter(Boolean),r=p(()=>{const s=e(l.result);return n("checkFinished",{problem:"invalidAddress",count:s.length}),s});return(s,i)=>_(r).length?(u(),a("div",ae,[de,o(k,null,{default:f(()=>[_e,t("ul",null,[(u(!0),a(v,null,$(_(r),(d,h)=>(u(),a("li",{key:h},[o(H,{from:d.origial,to:d.formatted},null,8,["from","to"])]))),128))])]),_:1})])):m("",!0)}},pe=S(he,[["__scopeId","data-v-8d555cc8"]]),me={__name:"CheckFormat",setup(c){const n=w(""),l=D(new Map),e=i=>{l.set(i.problem,i.count)},r=p(()=>Array.from(l.values()).reduce((i,d)=>i+d,0)>0),s=p(()=>n.value.length<1||r.value?"":"問題ありません！");return(i,d)=>(u(),a(v,null,[o(M,{onUpdateContent:d[0]||(d[0]=h=>n.value=h.content)}),t("p",null,[t("strong",null,b(_(s)),1)]),o(ne,{result:n.value,onCheckFinished:e},null,8,["result"]),o(ue,{result:n.value,onCheckFinished:e},null,8,["result"]),o(pe,{result:n.value,onCheckFinished:e},null,8,["result"]),o(Q,{result:n.value,onCheckFinished:e},null,8,["result"]),o(ce,{result:n.value,onCheckFinished:e},null,8,["result"]),o(Y,{result:n.value,onCheckFinished:e},null,8,["result"])],64))}},fe={class:"check-format"},ke=t("h1",null,"索引の体裁チェック",-1),Fe={__name:"CheckView",setup(c){return(n,l)=>(u(),a("div",fe,[ke,o(me),o(j)]))}};export{Fe as default};
