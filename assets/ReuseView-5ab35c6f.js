import{S as T}from"./SectionEnd-07fd441b.js";import{P as E,a as F}from"./PasteBox-39580ba4.js";import{R}from"./ResultBox-4bb31c6f.js";import{_ as B,i as v,j as f,o as p,a as h,b as c,u as x,e as n,t as C,F as w,g as O,h as U,p as j,d as H,f as b,r as y}from"./index-294494d2.js";import{E as L,A as N}from"./entryHandler-ea7f15d2.js";import{C as W}from"./CopyButton-9d509e71.js";const D=u=>{const t=String(u).match(/\d[\d,\u2013]*$/);return t?t[0]:""},I=["‐","‑","‒","–","—","―","－","─","-"],P=u=>{let t=u.split(",")[0];return t=t.replace(/\d+$/,""),I.includes(t.at(-1))&&t.at(-2).match(/\d/)&&(t=t.replace(/.$/,""),t=t.replace(/\d+$/,"")),t};class A{constructor(t){this.valiation=I,this.rawStr=t}format(t="–"){let e=this.rawStr;return this.valiation.forEach(r=>{e=e.replaceAll(r,"-")}),e.replace(/\u002d+/g,t)}getHeaderLen(){let t=0;for(let e=0;e<this.rawStr.length&&this.valiation.includes(this.rawStr[e]);e++)t+=1;return t}getTrailerLen(){let t=0;for(let e=this.rawStr.length-1;0<=e&&this.valiation.includes(this.rawStr[e]);e--)t+=1;return t}formatChildEntry(){const t=this.getHeaderLen(),e=t>0?"――":"",r=this.getTrailerLen(),d=r>0?"――":"";return e+this.rawStr.slice(t,this.rawStr.length-r)+d}}class q{constructor(t){this.prefix=t.startsWith(" ")||t.startsWith("　")?"　":"";const e=String(t).replace(/\uff0c/g,",").replace(/\s+/g,""),r=D(new A(e).format());if(r.length>0){this.address=r.replaceAll(",",", "),this.name=P(e);return}if(this.address="",e.indexOf("→")!=-1){this.name=e.replace(/→/,"　→");return}this.name=e}getFormattedLine(){const t=this.prefix+new A(this.name).formatChildEntry();return this.address.length>0?t+"　　"+this.address:t}}const V=u=>(j("data-v-a937757c"),u=u(),H(),u),z=V(()=>n("h2",null,"ゲラから抽出した索引データの整形",-1)),G=V(()=>n("ul",null,[n("li",null,[n("strong",null,"ゲラからテキストを抽出すると長い行が折り返されて改行になっていることがあります。"),n("ul",null,[n("li",null,"そうした箇所は先に手動で整形してください。")])]),n("li",null,"見よ項目の矢印の前のアキを1倍モノに統一します。"),n("li",null,[b("連続するノンブルを示すダーシの種類を"),n("code",null,"–"),b("（enダーシ）に統一します。")]),n("li",null,[b("子項目のダーシの種類を"),n("code",null,"――"),b("（2倍ダーシ）に統一します。")])],-1)),J={key:0},K={class:"detail"},M={class:"original"},Q={class:"formatted"},X={__name:"FormatOld",setup(u){const t=s=>s.map(l=>String(l).trimEnd().replace(/\t/,"　　")).map(l=>({formatted:new q(l).getFormattedLine(),original:l})),e=v(""),r=v([]),d=v(""),g=f(()=>F(e.value)),_=f(()=>r.value.map(s=>s.formatted).join(`
`)),a=f(()=>r.value.filter(s=>s.formatted!=s.original)),i=()=>{r.value=[]},o=()=>{i(),r.value=t(g.value),a.value.length>0?d.value=a.value.length+"箇所を修正しました！":d.value="問題のある箇所は見当たりませんでした！"};return(s,l)=>(p(),h(w,null,[z,c(E,{onUpdateContent:l[0]||(l[0]=m=>e.value=m.target.value),onButtonClicked:o}),G,c(R,{result:x(_)},null,8,["result"]),n("div",null,[n("h4",null,C(d.value),1),x(a).length?(p(),h("ol",J,[(p(!0),h(w,null,O(x(a),(m,S)=>(p(),h("li",{key:S},[n("ul",K,[n("li",M,C(m.original),1),n("li",Q,C(m.formatted),1)])]))),128))])):U("",!0)])],64))}},Y=B(X,[["__scopeId","data-v-a937757c"]]),Z="/sakuin-tool/assets/resolveChild-958e8e93.png",tt=n("h2",null,"子項目の復元",-1),et=n("div",null,[n("img",{src:Z,alt:""})],-1),nt={__name:"ResolveChild",setup(u){const t=o=>{const s=[],l=[];s.push(o[0]),l.push(new L(o[0]).basename);for(let m=1;m<o.length;m++){const S=new L(o[m]),$=S.basename;if($.startsWith("――")){const k=l.at(-1)+$.substring(2);s.push(k+"　　"+S.address)}else if($.endsWith("――")){const k=$.substring(0,$.length-2)+l.at(-1);s.push(k+"　　"+S.address)}else s.push(S.rawStr),l.push($)}return s},e=v(""),r=v([]),d=f(()=>F(e.value)),g=f(()=>d.value.map(o=>o.trim()).filter(o=>o.length)),_=f(()=>r.value.join(`
`)),a=()=>{r.value=[]},i=()=>{a(),r.value=t(g.value)};return(o,s)=>(p(),h(w,null,[tt,c(E,{onUpdateContent:s[0]||(s[0]=l=>e.value=l.target.value),onButtonClicked:i}),c(R,{result:x(_)},null,8,["result"]),et],64))}},st="/sakuin-tool/assets/ungroup-57a732db.png",rt={name:"UngroupedTable",props:{lines:Array,resultStr:String},components:{CopyButton:W}},ot={key:0},lt={class:"limit-height"},at=n("thead",null,[n("tr",null,[n("th",null,"項目"),n("th",null,"ノンブル")])],-1);function ut(u,t,e,r,d,g){const _=y("CopyButton");return e.lines.length?(p(),h("div",ot,[n("div",lt,[n("table",null,[at,n("tbody",null,[(p(!0),h(w,null,O(e.lines,(a,i)=>(p(),h("tr",{key:i},[n("td",null,C(a.name),1),n("td",null,C(a.nombre),1)]))),128))])])]),c(_,{copyStr:e.resultStr},null,8,["copyStr"])])):U("",!0)}const it=B(rt,[["render",ut]]),ct=n("h2",null,"名開き",-1),dt=n("div",null,[n("img",{src:st,alt:""})],-1),mt={__name:"Ungroup",setup(u){const t=i=>{const o=[];return i.filter(s=>s.trim()).map(s=>s.replace("	","　　")).forEach(s=>{const l=new L(s);l.isReference?o.push({name:l.name,nombre:""}):new N(l.address).nombres.forEach(m=>{o.push({name:l.name,nombre:m.display.text})})}),o},e=v(""),r=v([]),d=f(()=>F(e.value)),g=f(()=>r.value.map(i=>`${i.name}	${i.nombre}`.trimEnd()).join(`
`)),_=()=>{r.value=[]},a=()=>{_(),r.value=t(d.value)};return(i,o)=>(p(),h(w,null,[ct,c(E,{onUpdateContent:o[0]||(o[0]=s=>e.value=s.target.value),onButtonClicked:a}),c(it,{lines:r.value,resultStr:x(g)},null,8,["lines","resultStr"]),dt],64))}},pt={name:"ReuseView",components:{SectionEnd:T,FormatOld:Y,ResolveChild:nt,Ungroup:mt}},ht={class:"reuse"},_t=n("h1",null,"旧版索引の再利用",-1);function ft(u,t,e,r,d,g){const _=y("FormatOld"),a=y("SectionEnd"),i=y("ResolveChild"),o=y("Ungroup");return p(),h("div",ht,[_t,c(_),c(a),c(i),c(a),c(o),c(a)])}const Ct=B(pt,[["render",ft]]);export{Ct as default};
