import{S as P}from"./SectionEnd-e212fdb4.js";import{_ as S,o as c,a as _,e as t,F as y,g as w,t as g,b as p,h as B,p as V,d as E,c as M,i as x,j as k,u as h,w as C,v as A,k as N,l as R,f as v,m as U,r as j,n as F}from"./index-a507774b.js";import{C as D,S as K,a as L,t as q}from"./SimpleTextarea-be389bb1.js";import{B as H}from"./BeforeAfter-13c11413.js";const O="/sakuin-tool/assets/template-image-52f629d1.png";const T=l=>(V("data-v-1d8806b1"),l=l(),E(),l),W={key:0},z={class:"limit-height"},G=T(()=>t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1)),J={class:"meta-info"},Q={class:"meta-info"},X=T(()=>t("td",null,null,-1)),Y=T(()=>t("td",null,null,-1)),Z={__name:"TemplateTable",props:{rows:Array,resultStr:String},setup(l){return(i,s)=>l.rows.length?(c(),_("div",W,[t("div",z,[t("table",null,[G,t("tbody",null,[(c(!0),_(y,null,w(l.rows,(r,d)=>(c(),_("tr",{key:d},[t("td",J,g(r.id),1),t("td",Q,g(r.idx),1),t("td",null,g(r.nombre),1),X,Y]))),128))])])]),p(D,{copyStr:l.resultStr},null,8,["copyStr"])])):B("",!0)}},tt=S(Z,[["__scopeId","data-v-1d8806b1"]]),et="/sakuin-tool/assets/generate-index-28f0eaa2.png",nt="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",ot={name:"ExcelSetting"},lt=M('<summary>TIPS：条件付き書式の設定</summary><img src="'+et+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+nt+'">',5),st=[lt];function rt(l,i,s,r,d,f){return c(),_("details",null,st)}const at=S(ot,[["render",rt]]);const ut={class:"nombre"},ct={class:"ui"},it=["onKeyup","tabindex"],dt={__name:"CountRow",props:{limit:Number,nombreIdx:Number},emits:["updateCounter"],setup(l,{emit:i}){const s=l,r=1e3,d=x(()=>Number(s.nombreIdx)+1),f=x(()=>Number(s.nombreIdx)+r),a=k(0),o=()=>{i("updateCounter",{nombre:d.value,counter:a.value})},e=u=>{const m=Number(u.target.getAttribute("tabindex"))+1;if(r+s.limit<=m)return;const $=document.querySelector(`[tabindex="${m}"]`);$&&($.focus(),$.select())},n=u=>{const m=Number(u.target.getAttribute("tabindex"))-1;if(m<r)return;const $=document.querySelector(`[tabindex="${m}"]`);$&&($.focus(),$.select())};return(u,b)=>(c(),_("tr",null,[t("td",ut,g(h(d)),1),t("td",ct,[C(t("input",{type:"number",min:"0","onUpdate:modelValue":b[0]||(b[0]=m=>a.value=m),onInput:o,onKeyup:[N(e,["right"]),N(n,["left"])],tabindex:h(f)},null,40,it),[[A,a.value]])])]))}},_t=S(dt,[["__scopeId","data-v-3db7c0c1"]]);const I=l=>(V("data-v-47d9b30e"),l=l(),E(),l),mt=I(()=>t("h2",null,"索引拾いのテンプレート生成",-1)),pt=["src"],ht=I(()=>t("p",null,[v("ゲラ上にマーカーを引いた項目を Excel に記入するためのテンプレートを作ります。"),t("br"),v("先にカウントしておくことで、入力作業に集中することができます。")],-1)),bt=["disabled"],ft={class:"wrapper"},$t=I(()=>t("table",{class:"only-header"},[t("thead",null,[t("tr",null,[t("th",null,"ページ"),v(),t("th",null,"個数")])])],-1)),xt={class:"main-content"},vt=I(()=>t("ul",null,[t("li",null,"上下キーでカウントを上下させられます"),t("li",null,"左右キーで入力欄を移動できます"),t("li",null,"見よ項目があれば見よ先項目とのペアで1つとカウントします")],-1)),gt={__name:"Pickup",setup(l){const i=k(250),s=R(new Map),r=a=>{s.set(a.nombre,a.counter)},d=x(()=>{const a=[];let o=0;return Array.from(s.keys()).filter(e=>s.get(e)>0).forEach((e,n)=>{for(let u=0;u<s.get(e);u++)o+=1,a.push({id:o,idx:n+1,nombre:e})}),a}),f=x(()=>[["ID","index","ページ","項目","見よ先"].join("	")].concat(d.value.map(e=>`${e.id}	${e.idx}	${e.nombre}		`)).join(`
`));return(a,o)=>(c(),_(y,null,[mt,t("p",null,[t("img",{src:h(O)},null,8,pt)]),ht,t("label",null,[v("総ページ数"),C(t("input",{type:"number",min:"1","onUpdate:modelValue":o[0]||(o[0]=e=>i.value=e),disabled:h(d).length},null,8,bt),[[A,i.value]])]),t("div",ft,[$t,t("div",xt,[t("table",null,[t("tbody",null,[(c(!0),_(y,null,w(i.value,(e,n)=>(c(),U(_t,{nombreIdx:n,limit:i.value,key:n,onUpdateCounter:r},null,8,["nombreIdx","limit"]))),128))])])])]),vt,p(tt,{rows:h(d),resultStr:h(f)},null,8,["rows","resultStr"]),p(at)],64))}},yt=S(gt,[["__scopeId","data-v-47d9b30e"]]),St="/sakuin-tool/assets/before-f6e4167d.png",kt="/sakuin-tool/assets/after-8fa046e6.png",It={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:D}},wt={key:0},Ct={class:"limit-height"},Tt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function Pt(l,i,s,r,d,f){const a=j("CopyButton");return s.lines.length?(c(),_("div",wt,[t("div",Ct,[t("table",null,[Tt,t("tbody",null,[(c(!0),_(y,null,w(s.lines,(o,e)=>(c(),_("tr",{key:e},[t("td",null,g(o.name),1),t("td",null,g(o.nombre),1)]))),128))])])]),p(a,{copyStr:s.resultStr},null,8,["copyStr"])])):B("",!0)}const Nt=S(It,[["render",Pt]]),Bt=t("h2",null,"入力済テンプレートの整形",-1),Vt=t("h3",null,"整形内容",-1),Et=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),v("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),v("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),At={__name:"Preformat",setup(l){const i=o=>{const e=[];return o.filter(n=>n.trim()).map(n=>n.split("	")).filter(n=>n.length>2).map(n=>n.map(u=>u.trim())).forEach(n=>{const u=q(n[0]),b=n[1],m=n[2];if(!(u.length<1||b.length<1)){if(m.length<1){e.push({nombre:u,name:b});return}e.push({nombre:"",name:`${b}　→${m}`}),e.push({nombre:u,name:`${m}（${b}）`})}}),e},s=k(""),r=k(!0),d=x(()=>{const o=L(s.value);return r.value?o.slice(1):o}),f=x(()=>i(d.value)),a=x(()=>f.value.map(o=>`${o.name}	${o.nombre}`).join(`
`));return(o,e)=>(c(),_(y,null,[Bt,p(H,{beforePath:h(St),afterPath:h(kt)},null,8,["beforePath","afterPath"]),Vt,Et,t("label",null,[C(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=n=>r.value=n)},null,512),[[F,r.value]]),v("先頭行をスキップする")]),p(K,{onUpdateContent:e[1]||(e[1]=n=>s.value=n.content)}),p(Nt,{lines:h(f),resultStr:h(a)},null,8,["lines","resultStr"])],64))}},Dt={class:"pickup"},Mt=t("h1",null,"事前準備",-1),Kt={__name:"PrepareView",setup(l){return(i,s)=>(c(),_("div",Dt,[Mt,p(yt),p(P),p(At),p(P)]))}};export{Kt as default};
