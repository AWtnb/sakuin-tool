import{S as V}from"./SectionEnd-ac0d5718.js";import{_ as k,o as i,a as u,F as g,g as w,e as n,t as f,h as N,f as v,b as p,r as B,i as b,j as _,w as y,z as x,u as $,y as I,q as E,p as M,d as T}from"./index-53cf79c6.js";import{S as C,a as P}from"./CopyButton-fcc1a434.js";import{E as L,A as S,R as F}from"./entry-bde8f7c1.js";const R={name:"PossibleList",props:{children:Array}},q={key:0},z={key:1};function W(a,e,t,s,o,d){return i(),u("ul",null,[(i(!0),u(g,null,w(t.children,(r,l)=>(i(),u("li",{key:l},[n("span",null,[r.pre.length?(i(),u("mark",q,f(r.pre),1)):N("",!0),v(f(r.rest),1),r.post.length?(i(),u("mark",z,f(r.post),1)):N("",!0)])]))),128))])}const H=k(R,[["render",W]]),O={name:"FoundTable",components:{PossibleList:H},props:{found:Array}},G={key:0},J={class:"limit-height"},K=n("thead",null,[n("tr",null,[n("th",null,"項目"),n("th",null,"子項目候補")])],-1);function Q(a,e,t,s,o,d){const r=B("PossibleList");return t.found.length?(i(),u("div",G,[n("div",J,[n("table",null,[K,n("tbody",null,[(i(!0),u(g,null,w(t.found,(l,j)=>(i(),u("tr",{key:j},[n("td",null,f(l.parent),1),n("td",null,[p(r,{children:l.children},null,8,["children"])])]))),128))])])])])):N("",!0)}const X=k(O,[["render",Q]]);class Y{constructor(e,t){this.name=e,this.mode=t,this.modified=!1,this.pre="",this.post="",this.rest=""}search(e){(this.mode=="all"||this.mode=="head")&&this.name.startsWith(e)&&(this.pre=e,this.modified=!0),this.rest=this.name.substring(this.pre.length),(this.mode=="all"||this.mode=="tail")&&this.name.endsWith(e)&&(this.post=e,this.modified=!0),this.rest=this.rest.substring(0,this.rest.length-this.post.length)}}class Z{constructor(e,t="tail"){this.mode=t,this.mainEntries=e.filter(s=>String(s).trim()).map(s=>new L(s)).filter(s=>!s.isReference&&!s.isChild).map(s=>({name:s.name,basename:s.basename}))}findPossibles(){return this.mainEntries.map(e=>{const t=e.basename,s=this.mainEntries.filter(o=>o.basename!=t).map(o=>{const d=new Y(o.basename,this.mode);return d.search(t),d.modified?d:null}).filter(Boolean);return{parent:e.name,children:s}}).filter(e=>e.children.length>0).sort((e,t)=>t.parent.length-e.parent.length)}}const ee=n("h2",null,"子項目候補をチェックする",-1),te={__name:"CheckChild",setup(a){const e=b(""),t=b("all"),s=_(()=>P(e.value)),o=_(()=>new Z(s.value,t.value).findPossibles());return(d,r)=>(i(),u(g,null,[ee,p(C,{onUpdateContent:r[0]||(r[0]=l=>e.value=l.content)}),n("div",null,[n("label",null,[y(n("input",{type:"radio",value:"tail","onUpdate:modelValue":r[1]||(r[1]=l=>t.value=l)},null,512),[[x,t.value]]),v("末尾一致")]),n("label",null,[y(n("input",{type:"radio",value:"head","onUpdate:modelValue":r[2]||(r[2]=l=>t.value=l)},null,512),[[x,t.value]]),v("先頭一致")]),n("label",null,[y(n("input",{type:"radio",value:"all","onUpdate:modelValue":r[3]||(r[3]=l=>t.value=l)},null,512),[[x,t.value]]),v("両方")])]),p(X,{found:$(o)},null,8,["found"])],64))}};const ne={name:"AddressDiff",props:{diffDetails:{type:Array,require:!0}}},se={key:0};function re(a,e,t,s,o,d){return i(!0),u(g,null,w(t.diffDetails,(r,l)=>(i(),u("span",{key:l},[n("del",null,f(r.before),1),n("span",{style:I({color:r.color})},f(r.text),5),r.isEnd?N("",!0):(i(),u("span",se,", "))]))),128)}const le=k(ne,[["render",re],["__scopeId","data-v-fe5cb16f"]]),A=a=>isNaN(Number(a))?a.replace(/[^\d]/g,""):a,ae=(a,e)=>{const t=a.map((s,o)=>{const d=e[o],r=o==a.length-1;return A(s)!=A(d)?{text:d,before:s,color:"#ff0080",isEnd:r}:{text:s,before:"",color:"#333",isEnd:r}});return{modified:t.some(s=>s.before.length>0),detail:t}};class oe{constructor(e,t,s){this.start=Number(e),this.end=Number(t),this.delta=Number(s)}adjustNombre(e){return this.start<=e.intValue&&e.intValue<=this.end?e.adjust(this.delta):e.text}apply(e){return e.map(t=>{const s=new L(t),o=new S(s.address).rawElements,d=o.map(r=>{const l=new S(r).nombres;return l.length>1?this.adjustNombre(l[0])+"–"+this.adjustNombre(l.at(-1)):this.adjustNombre(l[0])});return{name:s.name,newNombres:d,comparison:ae(o,d)}})}}const ie=a=>(M("data-v-071a22f0"),a=a(),T(),a),ue=ie(()=>n("h2",null,"ノンブル加算減算",-1)),de={class:"config"},ce={key:0},me={__name:"PlusMinus",setup(a){const e=b(""),t=b(1),s=b(999),o=b(1),d=_(()=>P(e.value)),r=_(()=>new oe(t.value,s.value,o.value).apply(d.value)),l=_(()=>r.value.filter(c=>c.comparison.modified).map(c=>({name:c.name,detail:c.comparison.detail}))),j=_(()=>e.value.length<1?"":l.value.length?l.value.length+"件の変更があります。":"修正箇所はありません。"),U=_(()=>r.value.map(c=>c.newNombres.length?`${c.name}　　${c.newNombres.join(", ")}`:c.name).join(`
`));return(c,h)=>(i(),u(g,null,[ue,n("ul",de,[n("li",null,[v("開始 "),y(n("input",{type:"number",min:"1","onUpdate:modelValue":h[0]||(h[0]=m=>t.value=m)},null,512),[[E,t.value]])]),n("li",null,[v("終了 "),y(n("input",{type:"number",min:"1","onUpdate:modelValue":h[1]||(h[1]=m=>s.value=m)},null,512),[[E,s.value]])]),n("li",null,[v("増分 "),y(n("input",{type:"number","onUpdate:modelValue":h[2]||(h[2]=m=>o.value=m)},null,512),[[E,o.value]])])]),p(C,{onUpdateContent:h[3]||(h[3]=m=>e.value=m.content)}),p(F,{result:$(U)},null,8,["result"]),n("div",null,[n("h4",null,f($(j)),1),$(l).length?(i(),u("ul",ce,[(i(!0),u(g,null,w($(l),(m,D)=>(i(),u("li",{key:D},[n("span",null,f(m.name)+"　　",1),p(le,{"diff-details":m.detail},null,8,["diff-details"])]))),128))])):N("",!0)])],64))}},pe=k(me,[["__scopeId","data-v-071a22f0"]]),he={class:"adjust"},fe=n("h1",null,"微調整",-1),ge={__name:"AdjustView",setup(a){return(e,t)=>(i(),u("div",he,[fe,p(te),p(V),p(pe),p(V)]))}};export{ge as default};
