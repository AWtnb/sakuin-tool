import{S as w}from"./SectionEnd-9029405c.js";import{P as x}from"./PasteBox-7411fd1f.js";import{R as B}from"./ResultBox-e6aa57b4.js";import{_,r as d,o as m,a as h,b as l,e as s,t as p,F as f,g as C,h as L,p as E,d as A,f as g}from"./index-f4bdc6de.js";import{E as $,A as F}from"./entryHandler-ea7f15d2.js";import{C as b}from"./CopyButton-d936930c.js";const R=e=>{const t=String(e).match(/\d[\d,\u2013]*$/);return t?t[0]:""},y=["‐","‑","‒","–","—","―","－","─","-"],U=e=>{let t=e.split(",")[0];return t=t.replace(/\d+$/,""),y.includes(t.at(-1))&&t.at(-2).match(/\d/)&&(t=t.replace(/.$/,""),t=t.replace(/\d+$/,"")),t};class v{constructor(t){this.valiation=y,this.rawStr=t}format(t="–"){let n=this.rawStr;return this.valiation.forEach(r=>{n=n.replaceAll(r,"-")}),n.replace(/\u002d+/g,t)}getHeaderLen(){let t=0;for(let n=0;n<this.rawStr.length&&this.valiation.includes(this.rawStr[n]);n++)t+=1;return t}getTrailerLen(){let t=0;for(let n=this.rawStr.length-1;0<=n&&this.valiation.includes(this.rawStr[n]);n--)t+=1;return t}formatChildEntry(){const t=this.getHeaderLen(),n=t>0?"――":"",r=this.getTrailerLen(),i=r>0?"――":"";return n+this.rawStr.slice(t,this.rawStr.length-r)+i}}class O{constructor(t){this.prefix=t.startsWith(" ")||t.startsWith("　")?"　":"";const n=String(t).replace(/\uff0c/g,",").replace(/\s+/g,""),r=R(new v(n).format());if(r.length>0){this.address=r.replaceAll(",",", "),this.name=U(n);return}if(this.address="",n.indexOf("→")!=-1){this.name=n.replace(/→/,"　→");return}this.name=n}getFormattedLine(){const t=this.prefix+new v(this.name).formatChildEntry();return this.address.length>0?t+"　　"+this.address:t}}const P=e=>e.map(t=>String(t).trimEnd().replace(/\t/,"　　")).map(t=>({formatted:new O(t).getFormattedLine(),original:t})),T={name:"FormatOld",data:function(){return{content:"",fmtArr:[],message:""}},components:{PasteBox:x,ResultBox:B},computed:{contentLines:function(){return this.content.split(/\n/).map(e=>String(e))},resultStr:function(){return this.fmtArr.map(e=>e.formatted).join(`
`)},modified:function(){return this.fmtArr.filter(e=>e.formatted!=e.original)}},methods:{reset:function(){this.fmtArr=[]},executeFormat:function(){this.reset(),P(this.contentLines).forEach(e=>{this.fmtArr.push(e)}),this.modified.length>0?this.message=this.modified.length+"箇所を修正しました！":this.message="問題のある箇所は見当たりませんでした！"}}},k=e=>(E("data-v-d105f9e1"),e=e(),A(),e),I=k(()=>s("h2",null,"ゲラから抽出した索引データの整形",-1)),V=k(()=>s("ul",null,[s("li",null,[s("strong",null,"ゲラからテキストを抽出すると長い行が折り返されて改行になっていることがあります。"),s("ul",null,[s("li",null,"そうした箇所は先に手動で整形してください。")])]),s("li",null,"見よ項目の矢印の前のアキを1倍モノに統一します。"),s("li",null,[g("連続するノンブルを示すダーシの種類を"),s("code",null,"–"),g("（enダーシ）に統一します。")]),s("li",null,[g("子項目のダーシの種類を"),s("code",null,"――"),g("（2倍ダーシ）に統一します。")])],-1)),H={key:0},N={class:"original"},W={class:"formatted"};function j(e,t,n,r,i,o){const u=d("PasteBox"),a=d("ResultBox");return m(),h(f,null,[I,l(u,{onUpdateContent:t[0]||(t[0]=c=>e.content=c.target.value),onButtonClicked:o.executeFormat},null,8,["onButtonClicked"]),V,l(a,{result:o.resultStr},null,8,["result"]),s("div",null,[s("h4",null,p(e.message),1),o.modified.length?(m(),h("ol",H,[(m(!0),h(f,null,C(o.modified,(c,S)=>(m(),h("li",{key:S},[s("ul",null,[s("li",N,p(c.original),1),s("li",W,p(c.formatted),1)])]))),128))])):L("",!0)])],64)}const D=_(T,[["render",j],["__scopeId","data-v-d105f9e1"]]),q="/sakuin-tool/assets/resolveChild-958e8e93.png",z=e=>{const t=[],n=[];t.push(e[0]),n.push(new $(e[0]).basename);for(let r=1;r<e.length;r++){const i=new $(e[r]),o=i.basename;if(o.startsWith("――")){const u=n.at(-1)+o.substring(2);t.push(u+"　　"+i.address)}else if(o.endsWith("――")){const u=o.substring(0,o.length-2)+n.at(-1);t.push(u+"　　"+i.address)}else t.push(i.rawStr),n.push(o)}return t},G={name:"ResolveChild",data:function(){return{content:"",fmtArr:[]}},components:{PasteBox:x,ResultBox:B},computed:{contentLines:function(){return this.content.split(/\n/).map(e=>String(e))},pureLines:function(){return this.contentLines.filter(e=>e.trim()).map(e=>e.trim())},resultStr:function(){return this.fmtArr.join(`
`)}},methods:{reset:function(){this.fmtArr=[]},executeFormat:function(){this.reset(),z(this.pureLines).forEach(e=>{this.fmtArr.push(e)})}}},J=s("h2",null,"子項目の復元",-1),K=s("div",null,[s("img",{src:q,alt:""})],-1);function M(e,t,n,r,i,o){const u=d("PasteBox"),a=d("ResultBox");return m(),h(f,null,[J,l(u,{onUpdateContent:t[0]||(t[0]=c=>e.content=c.target.value),onButtonClicked:o.executeFormat},null,8,["onButtonClicked"]),l(a,{result:o.resultStr},null,8,["result"]),K],64)}const Q=_(G,[["render",M]]),X={name:"UngroupedTable",props:{lines:Array,resultStr:String},components:{CopyButton:b}},Y={key:0},Z={class:"limit-height"},tt=s("thead",null,[s("tr",null,[s("th",null,"項目"),s("th",null,"ノンブル")])],-1);function et(e,t,n,r,i,o){const u=d("CopyButton");return n.lines.length?(m(),h("div",Y,[s("div",Z,[s("table",null,[tt,s("tbody",null,[(m(!0),h(f,null,C(n.lines,(a,c)=>(m(),h("tr",{key:c},[s("td",null,p(a.name),1),s("td",null,p(a.nombre),1)]))),128))])])]),l(u,{copyStr:n.resultStr},null,8,["copyStr"])])):L("",!0)}const nt=_(X,[["render",et]]),st="/sakuin-tool/assets/ungroup-57a732db.png",rt=e=>{const t=[];return e.filter(n=>n.trim()).map(n=>n.replace("	","　　")).forEach(n=>{const r=new $(n);r.isReference?t.push({name:r.name,nombre:""}):new F(r.address).nombres.forEach(i=>{t.push({name:r.name,nombre:i.display.text})})}),t},ot={name:"Ungroup",data:function(){return{content:"",ungroupedLines:[]}},components:{CopyButton:b,PasteBox:x,UngroupedTable:nt},computed:{contentLines:function(){return this.content.split(/\n/).map(e=>String(e))},resultStr:function(){return this.ungroupedLines.map(e=>`${e.name}	${e.nombre}`.trimEnd()).join(`
`)}},methods:{reset:function(){this.ungroupedLines=[]},executeFormat:function(){this.reset(),rt(this.contentLines).forEach((e,t)=>{this.ungroupedLines.push(e)})}}},it=s("h2",null,"名開き",-1),ut=s("div",null,[s("img",{src:st,alt:""})],-1);function lt(e,t,n,r,i,o){const u=d("PasteBox"),a=d("UngroupedTable");return m(),h(f,null,[it,l(u,{onUpdateContent:t[0]||(t[0]=c=>e.content=c.target.value),onButtonClicked:o.executeFormat},null,8,["onButtonClicked"]),l(a,{lines:e.ungroupedLines,resultStr:o.resultStr},null,8,["lines","resultStr"]),ut],64)}const at=_(ot,[["render",lt]]),ct={name:"ReuseView",components:{SectionEnd:w,FormatOld:D,ResolveChild:Q,Ungroup:at}},dt={class:"reuse"},mt=s("h1",null,"旧版索引の再利用",-1);function ht(e,t,n,r,i,o){const u=d("FormatOld"),a=d("SectionEnd"),c=d("ResolveChild"),S=d("Ungroup");return m(),h("div",dt,[mt,l(u),l(a),l(c),l(a),l(S),l(a)])}const xt=_(ct,[["render",ht]]);export{xt as default};
