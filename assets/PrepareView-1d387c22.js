import{S as A}from"./SectionEnd-7fc4b3d2.js";import{_ as C,r as P,o as c,a as i,e as t,F as T,g as I,t as x,b as a,h as V,c as H,i as h,j as B,w as E,v as N,f as $,u as g}from"./index-c31636e5.js";import{P as w,t as D,a as F}from"./PasteBox-3b63b5a3.js";import{B as L}from"./BeforeAfter-e87c72b7.js";import{C as U}from"./CopyButton-b84eeed1.js";const M="/sakuin-tool/assets/before-d3cd42c2.png",O="/sakuin-tool/assets/after-2f5032e0.png",R={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:U}},G={key:0},W={class:"limit-height"},q=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),z=t("td",null,null,-1),J=t("td",null,null,-1);function K(b,_,n,s,u,m){const d=P("CopyButton");return n.lines.length?(c(),i("div",G,[t("div",W,[t("table",null,[q,t("tbody",null,[(c(!0),i(T,null,I(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,x(r.id),1),t("td",null,x(r.pageIdx),1),t("td",null,x(r.page),1),z,J]))),128))])])]),a(d,{copyStr:n.resultStr},null,8,["copyStr"])])):V("",!0)}const Q=C(R,[["render",K]]),X="/sakuin-tool/assets/generate-index-28f0eaa2.png",Y="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",Z={name:"ExcelSetting"},tt=H('<summary>TIPS：条件付き書式の設定</summary><img src="'+X+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+Y+'">',5),et=[tt];function nt(b,_,n,s,u,m){return c(),i("details",null,et)}const ot=C(Z,[["render",nt]]),lt=t("h2",null,"索引拾いのテンプレート生成",-1),st=t("p",null,[$("※"),t("code",null,"個数"),$("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1),rt={__name:"Pickup",setup(b){const _=o=>{const e=[];let l=0;return o.filter(S=>S).forEach(S=>{const[f,v,...j]=S.split("	"),k=D(v);if(Number(k)>0){l+=1;for(let y=0;y<Number(k);y++)e.push({id:String(e.length+1),pageIdx:String(l),page:String(f)})}}),e},n=h(""),s=h([]),u=h(!0),m=B(()=>{const o=F(n.value);return u.value?o.slice(1):o}),d=B(()=>["ID	index	ページ	項目	見よ先"].concat(s.value.map(e=>`${e.id}	${e.pageIdx}	${e.page}		`)).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(T,null,[lt,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l)},null,512),[[N,u.value]]),$("先頭行をスキップする")]),a(w,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),a(Q,{lines:s.value,resultStr:g(d)},null,8,["lines","resultStr"]),a(L,{beforePath:g(M),afterPath:g(O)},null,8,["beforePath","afterPath"]),st,a(ot)],64))}},at="/sakuin-tool/assets/before-f6e4167d.png",ut="/sakuin-tool/assets/after-8fa046e6.png",ct={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:U}},it={key:0},dt={class:"limit-height"},pt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function _t(b,_,n,s,u,m){const d=P("CopyButton");return n.lines.length?(c(),i("div",it,[t("div",dt,[t("table",null,[pt,t("tbody",null,[(c(!0),i(T,null,I(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,x(r.name),1),t("td",null,x(r.nombre),1)]))),128))])])]),a(d,{copyStr:n.resultStr},null,8,["copyStr"])])):V("",!0)}const mt=C(ct,[["render",_t]]),ft=t("h2",null,"入力済テンプレートの整形",-1),ht=t("h3",null,"整形内容",-1),gt=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),$("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),$("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),$t={__name:"Preformat",setup(b){const _=o=>{const e=[];return o.filter(l=>l.trim()).forEach(l=>{const[S,f,v,...j]=l.split("	").map(y=>y.trim()),k=String(D(S));String(v).length>0?(e.push({nombre:"",name:`${f}　→${v}`}),e.push({nombre:k,name:`${v}（${f}）`})):String(f).length>0&&e.push({nombre:k,name:f})}),e},n=h(""),s=h([]),u=h(!0),m=B(()=>{const o=F(n.value);return u.value?o.slice(1):o}),d=B(()=>s.value.map(o=>`${o.name}	${o.nombre}`).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(T,null,[ft,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>u.value=l)},null,512),[[N,u.value]]),$("先頭行をスキップする")]),a(w,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),ht,gt,a(mt,{lines:s.value,resultStr:g(d)},null,8,["lines","resultStr"]),a(L,{beforePath:g(at),afterPath:g(ut)},null,8,["beforePath","afterPath"])],64))}},bt={name:"PrepareView",components:{SectionEnd:A,Pickup:rt,Preformat:$t}},St={class:"pickup"},vt=t("h1",null,"事前準備",-1);function kt(b,_,n,s,u,m){const d=P("Pickup"),r=P("SectionEnd"),p=P("Preformat");return c(),i("div",St,[vt,a(d),a(r),a(p),a(r)])}const Tt=C(bt,[["render",kt]]);export{Tt as default};
