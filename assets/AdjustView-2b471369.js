import{S as j}from"./SectionEnd-2e8d91c5.js";import{_ as x,o as i,a as u,F as g,g as N,e as r,t as p,h as $,f as k,b as m,r as T,i as y,j as b,w,n as C,u as v,q as I,m as S,p as B,d as D}from"./index-97f0a3ac.js";import{S as L,a as A}from"./CopyButton-0833e2e3.js";import{E as P,A as E,R as F}from"./ResultBox-9cdf6855.js";const R={name:"PossibleList",props:{children:Array}},H={key:0},q={key:1};function W(o,e,t,n,a,d){return i(),u("ul",null,[(i(!0),u(g,null,N(t.children,(s,l)=>(i(),u("li",{key:l},[r("span",null,[s.pre.length?(i(),u("mark",H,p(s.pre),1)):$("",!0),k(p(s.rest),1),s.post.length?(i(),u("mark",q,p(s.post),1)):$("",!0)])]))),128))])}const z=x(R,[["render",W]]),O={name:"FoundTable",components:{PossibleList:z},props:{found:Array}},G={key:0},J={class:"limit-height"},K=r("thead",null,[r("tr",null,[r("th",null,"項目"),r("th",null,"子項目候補")])],-1);function Q(o,e,t,n,a,d){const s=T("PossibleList");return t.found.length?(i(),u("div",G,[r("div",J,[r("table",null,[K,r("tbody",null,[(i(!0),u(g,null,N(t.found,(l,h)=>(i(),u("tr",{key:h},[r("td",null,p(l.parent),1),r("td",null,[m(s,{children:l.children},null,8,["children"])])]))),128))])])])])):$("",!0)}const X=x(O,[["render",Q]]);class Y{constructor(e,t){this.name=e,this.mode=t,this.modified=!1,this.pre="",this.post="",this.rest=""}search(e){(this.mode=="all"||this.mode=="head")&&this.name.startsWith(e)&&(this.pre=e,this.modified=!0),this.rest=this.name.substring(this.pre.length),(this.mode=="all"||this.mode=="tail")&&this.name.endsWith(e)&&(this.post=e,this.modified=!0),this.rest=this.rest.substring(0,this.rest.length-this.post.length)}}class Z{constructor(e,t="tail"){this.mode=t,this.mainEntries=e.filter(n=>String(n).trim()).map(n=>new P(n)).filter(n=>!n.isReference&&!n.isChild).map(n=>({name:n.name,basename:n.basename}))}findPossibles(){return this.mainEntries.map(e=>{const t=e.basename,n=this.mainEntries.filter(a=>a.basename!=t).map(a=>{const d=new Y(a.basename,this.mode);return d.search(t),d.modified?d:null}).filter(Boolean);return{parent:e.name,children:n}}).filter(e=>e.children.length>0).sort((e,t)=>t.parent.length-e.parent.length)}}const ee=r("h2",null,"子項目候補をチェックする",-1),te={__name:"CheckChild",setup(o){const e=y(""),t=y("all"),n=b(()=>A(e.value)),a=b(()=>new Z(n.value,t.value).findPossibles());return(d,s)=>(i(),u(g,null,[ee,m(L,{onUpdateContent:s[0]||(s[0]=l=>e.value=l.target.value)}),r("div",null,[r("label",null,[w(r("input",{type:"radio",value:"tail","onUpdate:modelValue":s[1]||(s[1]=l=>t.value=l)},null,512),[[C,t.value]]),k("末尾一致")]),r("label",null,[w(r("input",{type:"radio",value:"head","onUpdate:modelValue":s[2]||(s[2]=l=>t.value=l)},null,512),[[C,t.value]]),k("先頭一致")]),r("label",null,[w(r("input",{type:"radio",value:"all","onUpdate:modelValue":s[3]||(s[3]=l=>t.value=l)},null,512),[[C,t.value]]),k("両方")])]),m(X,{found:v(a)},null,8,["found"])],64))}};const ne={name:"AddressDiff",props:{diffDetails:{type:Array,require:!0}}},se={key:0};function re(o,e,t,n,a,d){return i(!0),u(g,null,N(t.diffDetails,(s,l)=>(i(),u("span",{key:l},[r("del",null,p(s.before),1),r("span",{style:I({color:s.color})},p(s.text),5),s.isEnd?$("",!0):(i(),u("span",se,", "))]))),128)}const le=x(ne,[["render",re],["__scopeId","data-v-fe5cb16f"]]),U=o=>isNaN(Number(o))?o.replace(/[^\d]/g,""):o,oe=(o,e)=>{const t=o.map((n,a)=>{const d=e[a],s=a==o.length-1;return U(n)!=U(d)?{text:d,before:n,color:"#ff0080",isEnd:s}:{text:n,before:"",color:"#333",isEnd:s}});return{modified:t.some(n=>n.before.length>0),detail:t}};class ae{constructor(e,t,n){this.start=e,this.end=t,this.delta=n}adjust(e){return Number(this.start)<=e.intValue&&e.intValue<=Number(this.end)?e.adjust(this.delta):e.text}}class ie{constructor(e,t,n,a){this.lines=e,this.adjuster=new ae(t,n,a)}adjust(){return this.lines.map(e=>{const t=new P(e),n=new E(t.address).rawElements,a=n.map(d=>{const s=new E(d).nombres;return s.length>1?this.adjuster.adjust(s[0])+"–"+this.adjuster.adjust(s.at(-1)):this.adjuster.adjust(s[0])});return{name:t.name,newNombres:a,comparison:oe(n,a)}})}}const ue=o=>(B("data-v-9d36c5d8"),o=o(),D(),o),de=ue(()=>r("h2",null,"ノンブル加算減算",-1)),ce={class:"config"},he={key:0},me={__name:"PlusMinus",setup(o){const e=y(""),t=y(1),n=y(999),a=y(1),d=b(()=>A(e.value)),s=b(()=>new ie(d.value,t.value,n.value,a.value).adjust()),l=b(()=>s.value.filter(c=>c.comparison.modified).map(c=>({name:c.name,detail:c.comparison.detail}))),h=b(()=>e.value.length<1?"":l.value.length?l.value.length+"件の変更があります。":"修正箇所はありません。"),V=b(()=>s.value.map(c=>c.newNombres.length?`${c.name}　　${c.newNombres.join(", ")}`:c.name).join(`
`));return(c,_)=>(i(),u(g,null,[de,r("ul",ce,[r("li",null,[k("開始 "),w(r("input",{type:"number",min:"1","onUpdate:modelValue":_[0]||(_[0]=f=>t.value=f)},null,512),[[S,t.value]])]),r("li",null,[k("終了 "),w(r("input",{type:"number",min:"1","onUpdate:modelValue":_[1]||(_[1]=f=>n.value=f)},null,512),[[S,n.value]])]),r("li",null,[k("増分 "),w(r("input",{type:"number","onUpdate:modelValue":_[2]||(_[2]=f=>a.value=f)},null,512),[[S,a.value]])])]),m(L,{onUpdateContent:_[3]||(_[3]=f=>e.value=f.target.value)}),m(F,{result:v(V)},null,8,["result"]),r("div",null,[r("h4",null,p(v(h)),1),v(l).length?(i(),u("ul",he,[(i(!0),u(g,null,N(v(l),(f,M)=>(i(),u("li",{key:M},[r("span",null,p(f.name)+"　　",1),m(le,{"diff-details":f.detail},null,8,["diff-details"])]))),128))])):$("",!0)])],64))}},pe=x(me,[["__scopeId","data-v-9d36c5d8"]]);class _e{constructor(e){const t=new P(e);this.nombres=new E(t.address).nombres,this.problems=[]}checkSort(){if(!(this.nombres.length<2)){for(let e=0;e<this.nombres.length-1;e++)if(this.nombres[e].intValue>=this.nombres[e+1].intValue){this.problems.push({color:"red",text:"順番！"});break}}}checkHyphen(){if(!(this.nombres.length<3))for(let e=0;e<this.nombres.length-2;e++){const t=this.nombres[e],n=this.nombres[e+1],a=this.nombres[e+2];if(t.intValue+1==n.intValue&&t.intValue+2==a.intValue&&!n.hyphenated){this.problems.push({color:"blue",text:"連続！"});break}}}}const fe=o=>(B("data-v-95e1d98f"),o=o(),D(),o),be=fe(()=>r("h2",null,"ノンブルの並びをチェックする",-1)),ve={key:0,class:"warning"},ge={key:1},ye={__name:"CheckNombre",setup(o){const e=s=>s.filter(l=>String(l).trim()).map(l=>{const h=new _e(l);return h.checkSort(),h.checkHyphen(),h.problems.length>0?{line:l,detail:h.problems}:null}).filter(Boolean),t=y(""),n=b(()=>A(t.value)),a=b(()=>t.value.length<1?"":d.value.length?"修正の必要があります！":"問題は見当たりません！"),d=b(()=>e(n.value));return(s,l)=>(i(),u(g,null,[be,m(L,{onUpdateContent:l[0]||(l[0]=h=>t.value=h.target.value)}),v(a)?(i(),u("strong",ve,p(v(a)),1)):$("",!0),v(d).length?(i(),u("ul",ge,[(i(!0),u(g,null,N(v(d),(h,V)=>(i(),u("li",{key:V},[r("span",null,p(h.line),1),(i(!0),u(g,null,N(h.detail,(c,_)=>(i(),u("span",{key:_},[r("span",{style:I({color:c.color})},"←"+p(c.text),5)]))),128))]))),128))])):$("",!0)],64))}},ke=x(ye,[["__scopeId","data-v-95e1d98f"]]),$e={class:"adjust"},we=r("h1",null,"微調整",-1),Ce={__name:"AdjustView",setup(o){return(e,t)=>(i(),u("div",$e,[we,m(te),m(j),m(pe),m(j),m(ke),m(j)]))}};export{Ce as default};
