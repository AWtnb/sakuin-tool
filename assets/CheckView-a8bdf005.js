import{S as I}from"./SectionEnd-00c69fac.js";import{a as x,S as B}from"./SimpleTextarea-967c8544.js";import{_ as F,j as S,o as c,a as i,b as n,k as E,s as j,e as L,z as M,h as m,i as p,u as d,d as u,w as g,F as f,g as v,t as k,A as N,p as U,f as q,m as D}from"./index-c967e13c.js";import{R as y,_ as $}from"./referenceChecker-7378e0ca.js";import{E as A,A as H}from"./entry-1c7d23b5.js";const T={class:"area"},z={key:0},P={__name:"IgnorableArea",setup(o){const t=S(!1);return(r,e)=>(c(),i("div",T,[n("label",null,[E(n("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>t.value=l)},null,512),[[j,t.value]]),L("無視する")]),t.value?m("",!0):(c(),i("div",z,[M(r.$slots,"default",{},void 0,!0)]))]))}},b=F(P,[["__scopeId","data-v-24f1f406"]]),G={key:0},O=n("h3",null,"見よ先の括弧書きが足りません：",-1),J=n("thead",null,[n("tr",null,[n("th",null,"見よ項目"),n("th",null,"必要な項目")])],-1),K={__name:"FindMissingBackLink",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=p(()=>{const s=new y(r.result).findMissingBackLink();return t("checkFinished",{problem:"missingBackLink",count:s.length}),s});return(l,s)=>d(e).length?(c(),i("div",G,[O,u(b,null,{default:g(()=>[n("table",null,[J,n("tbody",null,[(c(!0),i(f,null,v(d(e),(a,h)=>(c(),i("tr",{key:h},[n("td",null,k(a.problem),1),n("td",null,k(a.require),1)]))),128))])])]),_:1})])):m("",!0)}},Q={key:0},W=n("h3",null,"見よ項目のすぐ隣に見よ先項目があります：",-1),X={__name:"FindAdjacent",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=p(()=>{const s=new y(r.result).findAdjacent();return t("checkFinished",{problem:"adjacent",count:s.length}),s});return(l,s)=>d(e).length?(c(),i("div",Q,[W,u(b,null,{default:g(()=>[u($,{arr:d(e)},null,8,["arr"])]),_:1})])):m("",!0)}},Y={key:0},Z=n("h3",null,"見よ項目が足りません：",-1),ee=n("thead",null,[n("tr",null,[n("th",null,"括弧のある項目"),n("th",null,"必要な見よ項目")])],-1),te={__name:"CheckMissingRef",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=p(()=>{const s=new y(r.result).findMissingRefs();return t("checkFinished",{problem:"missingRef",count:s.length}),s});return(l,s)=>d(e).length?(c(),i("div",Y,[Z,u(b,null,{default:g(()=>[n("table",null,[ee,n("tbody",null,[(c(!0),i(f,null,v(d(e),(a,h)=>(c(),i("tr",{key:h},[n("td",null,k(a.problem),1),n("td",null,[u($,{arr:a.require},null,8,["arr"])])]))),128))])])]),_:1})])):m("",!0)}},ne=n("thead",null,[n("tr",null,[n("th",null,"重複項目")])],-1),w={__name:"DuplicateTable",props:{detailsArr:Array},setup(o){return(t,r)=>(c(),i("table",null,[ne,n("tbody",null,[(c(!0),i(f,null,v(o.detailsArr,(e,l)=>(c(),i("tr",{key:l},[n("td",null,[u($,{arr:e},null,8,["arr"])])]))),128))])]))}};class R{constructor(t){const r=x(t);this.entries=r.filter(e=>String(e).trim()).map(e=>new A(e)),this.refs=this.entries.filter(e=>e.isReference),this.nonRefs=this.entries.filter(e=>!e.isReference),this.mainEntries=this.nonRefs.filter(e=>!e.isChild)}getUngrouped(){const t=[];return this.mainEntries.forEach(e=>{const l=e.basename,s=this.mainEntries.filter(a=>a.basename==l).map(a=>a.rawStr);s.length!=1&&t.push(s)}),t.filter((e,l,s)=>l===s.findIndex(a=>a.join("")===e.join("")))}getConflicting(){return this.refs.map(t=>{const r=t.basename,e=this.mainEntries.filter(l=>l.basename==r);return e.length<1?null:[t.name].concat(e.map(l=>l.rawStr))}).filter(Boolean)}}const se={key:0},re=n("h3",null,"見よ項目が本項目として残っています：",-1),le={__name:"CheckConflict",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=p(()=>{const s=new R(r.result).getConflicting();return t("checkFinished",{problem:"conflictReference",count:s.length}),s});return(l,s)=>d(e).length?(c(),i("div",se,[re,u(b,null,{default:g(()=>[u(w,{detailsArr:d(e)},null,8,["detailsArr"])]),_:1})])):m("",!0)}},oe={key:0},ce=n("h3",null,"名寄せが不十分です：",-1),ie={__name:"CheckUngrouped",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=p(()=>{const s=new R(r.result).getUngrouped();return t("checkFinished",{problem:"ungrouped",count:s.length}),s});return(l,s)=>d(e).length?(c(),i("div",oe,[ce,u(b,null,{default:g(()=>[u(w,{detailsArr:d(e)},null,8,["detailsArr"])]),_:1})])):m("",!0)}};class ue{constructor(t){const r=new A(t);this.nombres=new H(r.address).nombres,this.problems=[]}checkSort(){if(!(this.nombres.length<2)){for(let t=0;t<this.nombres.length-1;t++)if(this.nombres[t].intValue>=this.nombres[t+1].intValue){this.problems.push({color:"red",text:"順番！"});break}}}checkHyphen(){if(!(this.nombres.length<3))for(let t=0;t<this.nombres.length-2;t++){const r=this.nombres[t],e=this.nombres[t+1],l=this.nombres[t+2];if(r.intValue+1==e.intValue&&r.intValue+2==l.intValue&&!e.hyphenated){this.problems.push({color:"blue",text:"連続！"});break}}}}const ae=o=>(U("data-v-33d6ea0e"),o=o(),q(),o),he={key:0},de=ae(()=>n("h3",null,"ノンブルの並びに問題があります：",-1)),_e={__name:"CheckAddress",props:{result:String},emits:["checkFinished"],setup(o,{emit:t}){const r=o,e=s=>x(s).filter(h=>String(h).trim()).map(h=>{const _=new ue(h);return _.checkSort(),_.checkHyphen(),_.problems.length>0?{line:h,detail:_.problems}:null}).filter(Boolean),l=p(()=>{const s=e(r.result);return t("checkFinished",{problem:"invalidAddress",count:s.length}),s});return(s,a)=>d(l).length?(c(),i("div",he,[de,u(b,null,{default:g(()=>[n("ul",null,[(c(!0),i(f,null,v(d(l),(h,_)=>(c(),i("li",{key:_},[n("span",null,k(h.line),1),(c(!0),i(f,null,v(h.detail,(C,V)=>(c(),i("span",{key:V},[n("span",{style:N({color:C.color})},"←"+k(C.text),5)]))),128))]))),128))])]),_:1})])):m("",!0)}},pe=F(_e,[["__scopeId","data-v-33d6ea0e"]]),me={__name:"CheckFormat",setup(o){const t=S(""),r=D(new Map),e=a=>{r.set(a.problem,a.count)},l=p(()=>Array.from(r.values()).reduce((a,h)=>a+h,0)>0),s=p(()=>t.value.length<1||l.value?"":"問題ありません！");return(a,h)=>(c(),i(f,null,[u(B,{onUpdateContent:h[0]||(h[0]=_=>t.value=_.content)}),n("p",null,[n("strong",null,k(d(s)),1)]),u(te,{result:t.value,onCheckFinished:e},null,8,["result"]),u(ie,{result:t.value,onCheckFinished:e},null,8,["result"]),u(pe,{result:t.value,onCheckFinished:e},null,8,["result"]),u(K,{result:t.value,onCheckFinished:e},null,8,["result"]),u(le,{result:t.value,onCheckFinished:e},null,8,["result"]),u(X,{result:t.value,onCheckFinished:e},null,8,["result"])],64))}},fe={class:"check-format"},ke=n("h1",null,"索引の体裁チェック",-1),Ce={__name:"CheckView",setup(o){return(t,r)=>(c(),i("div",fe,[ke,u(me),u(I)]))}};export{Ce as default};
