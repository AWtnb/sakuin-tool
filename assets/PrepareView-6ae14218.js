import{S as T}from"./SectionEnd-c9716df7.js";import{_ as C,o as c,a as i,e as t,F as B,g as I,t as k,b as s,h as V,r as N,c as H,i as h,j as P,u as g,w as E,v as w,f as $}from"./index-71ca2f42.js";import{P as D,t as F,a as L}from"./PasteBox-23b110c5.js";import{B as U}from"./BeforeAfter-0fe09635.js";import{C as j}from"./CopyButton-32423f15.js";const M="/sakuin-tool/assets/before-d3cd42c2.png",O="/sakuin-tool/assets/after-2f5032e0.png",R={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:j}},G={key:0},W={class:"limit-height"},q=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),z=t("td",null,null,-1),J=t("td",null,null,-1);function K(b,d,n,r,a,m){const p=N("CopyButton");return n.lines.length?(c(),i("div",G,[t("div",W,[t("table",null,[q,t("tbody",null,[(c(!0),i(B,null,I(n.lines,(u,_)=>(c(),i("tr",{key:_},[t("td",null,k(u.id),1),t("td",null,k(u.pageIdx),1),t("td",null,k(u.page),1),z,J]))),128))])])]),s(p,{copyStr:n.resultStr},null,8,["copyStr"])])):V("",!0)}const Q=C(R,[["render",K]]),X="/sakuin-tool/assets/generate-index-28f0eaa2.png",Y="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",Z={name:"ExcelSetting"},tt=H('<summary>TIPS：条件付き書式の設定</summary><img src="'+X+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+Y+'">',5),et=[tt];function nt(b,d,n,r,a,m){return c(),i("details",null,et)}const lt=C(Z,[["render",nt]]),ot=t("h2",null,"索引拾いのテンプレート生成",-1),st=t("p",null,[$("※"),t("code",null,"個数"),$("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1),rt={__name:"Pickup",setup(b){const d=l=>{const e=[];let o=0;return l.filter(v=>v).forEach(v=>{const[f,S,...A]=v.split("	"),x=F(S);if(Number(x)>0){o+=1;for(let y=0;y<Number(x);y++)e.push({id:String(e.length+1),pageIdx:String(o),page:String(f)})}}),e},n=h(""),r=h([]),a=h(!0),m=P(()=>{const l=L(n.value);return a.value?l.slice(1):l}),p=P(()=>["ID	index	ページ	項目	見よ先"].concat(r.value.map(e=>`${e.id}	${e.pageIdx}	${e.page}		`)).join(`
`)),u=()=>{r.value=[]},_=()=>{u(),r.value=d(m.value)};return(l,e)=>(c(),i(B,null,[ot,s(U,{beforePath:g(M),afterPath:g(O)},null,8,["beforePath","afterPath"]),st,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.value=o)},null,512),[[w,a.value]]),$("先頭行をスキップする")]),s(D,{onUpdateContent:e[1]||(e[1]=o=>n.value=o.target.value),onButtonClicked:_}),s(Q,{lines:r.value,resultStr:g(p)},null,8,["lines","resultStr"]),s(lt)],64))}},at="/sakuin-tool/assets/before-f6e4167d.png",ut="/sakuin-tool/assets/after-8fa046e6.png",ct={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:j}},it={key:0},dt={class:"limit-height"},pt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function _t(b,d,n,r,a,m){const p=N("CopyButton");return n.lines.length?(c(),i("div",it,[t("div",dt,[t("table",null,[pt,t("tbody",null,[(c(!0),i(B,null,I(n.lines,(u,_)=>(c(),i("tr",{key:_},[t("td",null,k(u.name),1),t("td",null,k(u.nombre),1)]))),128))])])]),s(p,{copyStr:n.resultStr},null,8,["copyStr"])])):V("",!0)}const mt=C(ct,[["render",_t]]),ft=t("h2",null,"入力済テンプレートの整形",-1),ht=t("h3",null,"整形内容",-1),gt=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),$("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),$("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),$t={__name:"Preformat",setup(b){const d=l=>{const e=[];return l.filter(o=>o.trim()).forEach(o=>{const[v,f,S,...A]=o.split("	").map(y=>y.trim()),x=String(F(v));String(S).length>0?(e.push({nombre:"",name:`${f}　→${S}`}),e.push({nombre:x,name:`${S}（${f}）`})):String(f).length>0&&e.push({nombre:x,name:f})}),e},n=h(""),r=h([]),a=h(!0),m=P(()=>{const l=L(n.value);return a.value?l.slice(1):l}),p=P(()=>r.value.map(l=>`${l.name}	${l.nombre}`).join(`
`)),u=()=>{r.value=[]},_=()=>{u(),r.value=d(m.value)};return(l,e)=>(c(),i(B,null,[ft,s(U,{beforePath:g(at),afterPath:g(ut)},null,8,["beforePath","afterPath"]),ht,gt,t("label",null,[E(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=o=>a.value=o)},null,512),[[w,a.value]]),$("先頭行をスキップする")]),s(D,{onUpdateContent:e[1]||(e[1]=o=>n.value=o.target.value),onButtonClicked:_}),s(mt,{lines:r.value,resultStr:g(p)},null,8,["lines","resultStr"])],64))}},bt={class:"pickup"},vt=t("h1",null,"事前準備",-1),Bt={__name:"PrepareView",setup(b){return(d,n)=>(c(),i("div",bt,[vt,s(rt),s(T),s($t),s(T)]))}};export{Bt as default};
