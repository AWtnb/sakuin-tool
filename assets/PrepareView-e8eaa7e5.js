import{S as H}from"./SectionEnd-92dbd953.js";import{_ as P,r as b,o as c,a as i,e as t,F as B,g as T,t as k,b as u,h as I,c as j,i as h,j as C,w as V,v as E,f as x,u as w}from"./index-b6e9e327.js";import{U as N}from"./utils-e1f3c5ba.js";import{P as U}from"./PasteBox-86529bff.js";import{C as D}from"./CopyButton-f764926e.js";const L="/sakuin-tool/assets/newtemplate-67fdefb0.png",A={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:D}},M={key:0},R={class:"limit-height"},W=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),G=t("td",null,null,-1),O=t("td",null,null,-1);function q(g,_,n,s,a,m){const d=b("CopyButton");return n.lines.length?(c(),i("div",M,[t("div",R,[t("table",null,[W,t("tbody",null,[(c(!0),i(B,null,T(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,k(r.id),1),t("td",null,k(r.pageIdx),1),t("td",null,k(r.page),1),G,O]))),128))])])]),u(d,{copyStr:n.resultStr},null,8,["copyStr"])])):I("",!0)}const z=P(A,[["render",q]]),J="/sakuin-tool/assets/generate-index-28f0eaa2.png",K="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",Q={name:"ExcelSetting"},X=j('<summary>TIPS：条件付き書式の設定</summary><img src="'+J+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+K+'">',5),Y=[X];function Z(g,_,n,s,a,m){return c(),i("details",null,Y)}const tt=P(Q,[["render",Z]]),et=t("h2",null,"索引拾いのテンプレート生成",-1),nt=t("div",null,[t("img",{src:L,alt:""})],-1),ot=t("p",null,[t("code",null,"個数"),x("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1),lt={__name:"Pickup",setup(g){const _=o=>{const e=[];let l=0;return o.filter($=>$).forEach($=>{const[f,S,...F]=$.split("	"),v=N.toHalfWidth(S);if(Number(v)>0){l+=1;for(let y=0;y<Number(v);y++)e.push({id:String(e.length+1),pageIdx:String(l),page:String(f)})}}),e},n=h(""),s=h([]),a=h(!0),m=C(()=>{const o=n.value.split(/\n/).map(e=>String(e));return a.value?o.slice(1):o}),d=C(()=>["ID	index	ページ	項目	見よ先"].concat(s.value.map(e=>`${e.id}	${e.pageIdx}	${e.page}		`)).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(B,null,[et,t("label",null,[V(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l)},null,512),[[E,a.value]]),x("先頭行をスキップする")]),u(U,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),u(z,{lines:s.value,resultStr:w(d)},null,8,["lines","resultStr"]),nt,ot,u(tt)],64))}},st="/sakuin-tool/assets/preformat-9f6a2373.png",rt={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:D}},at={key:0},ut={class:"limit-height"},ct=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function it(g,_,n,s,a,m){const d=b("CopyButton");return n.lines.length?(c(),i("div",at,[t("div",ut,[t("table",null,[ct,t("tbody",null,[(c(!0),i(B,null,T(n.lines,(r,p)=>(c(),i("tr",{key:p},[t("td",null,k(r.name),1),t("td",null,k(r.nombre),1)]))),128))])])]),u(d,{copyStr:n.resultStr},null,8,["copyStr"])])):I("",!0)}const dt=P(rt,[["render",it]]),pt=t("h2",null,"入力済テンプレートの整形",-1),_t=t("h3",null,"整形内容",-1),mt=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),x("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),x("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),ft=t("div",null,[t("img",{src:st,alt:""})],-1),ht={__name:"Preformat",setup(g){const _=o=>{const e=[];return o.filter(l=>l.trim()).forEach(l=>{const[$,f,S,...F]=l.split("	").map(y=>y.trim()),v=String(N.toHalfWidth($));String(S).length>0?(e.push({nombre:"",name:`${f}　→${S}`}),e.push({nombre:v,name:`${S}（${f}）`})):String(f).length>0&&e.push({nombre:v,name:f})}),e},n=h(""),s=h([]),a=h(!0),m=C(()=>{const o=n.value.split(/\n/).map(e=>String(e));return a.value?o.slice(1):o}),d=C(()=>s.value.map(o=>`${o.name}	${o.nombre}`).join(`
`)),r=()=>{s.value=[]},p=()=>{r(),s.value=_(m.value)};return(o,e)=>(c(),i(B,null,[pt,t("label",null,[V(t("input",{type:"checkbox","onUpdate:modelValue":e[0]||(e[0]=l=>a.value=l)},null,512),[[E,a.value]]),x("先頭行をスキップする")]),u(U,{onUpdateContent:e[1]||(e[1]=l=>n.value=l.target.value),onButtonClicked:p}),_t,mt,u(dt,{lines:s.value,resultStr:w(d)},null,8,["lines","resultStr"]),ft],64))}},gt={name:"PrepareView",components:{SectionEnd:H,Pickup:lt,Preformat:ht}},$t={class:"pickup"},St=t("h1",null,"事前準備",-1);function vt(g,_,n,s,a,m){const d=b("Pickup"),r=b("SectionEnd"),p=b("Preformat");return c(),i("div",$t,[St,u(d),u(r),u(p),u(r)])}const Pt=P(gt,[["render",vt]]);export{Pt as default};
