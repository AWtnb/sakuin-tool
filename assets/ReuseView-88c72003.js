import{S as $}from"./SectionEnd-2e8d91c5.js";import{S as x,a as L,C as R}from"./CopyButton-0833e2e3.js";import{R as C,E as w,A as U}from"./ResultBox-9cdf6855.js";import{_ as P,i as k,j as i,o as m,a as p,b as o,u as d,e as a,t as b,F as S,g as A,h as B,c as T,r as V}from"./index-97f0a3ac.js";import{B as F}from"./BeforeAfter-b5271929.js";const j=f=>{const t=String(f).match(/\d[\d,\u2013]*$/);return t?t[0]:""},O=["‐","‑","‒","–","—","―","－","─","-"],H=f=>{let t=f.split(",")[0];return t=t.replace(/\d+$/,""),O.includes(t.at(-1))&&t.at(-2).match(/\d/)&&(t=t.replace(/.$/,""),t=t.replace(/\d+$/,"")),t};class E{constructor(t){this.valiation=O,this.rawStr=t}format(t="–"){let e=this.rawStr;return this.valiation.forEach(l=>{e=e.replaceAll(l,"-")}),e.replace(/\u002d+/g,t)}getHeaderLen(){let t=0;for(let e=0;e<this.rawStr.length&&this.valiation.includes(this.rawStr[e]);e++)t+=1;return t}getTrailerLen(){let t=0;for(let e=this.rawStr.length-1;0<=e&&this.valiation.includes(this.rawStr[e]);e--)t+=1;return t}formatChildEntry(){const t=this.getHeaderLen(),e=t>0?"――":"",l=this.getTrailerLen(),h=l>0?"――":"";return e+this.rawStr.slice(t,this.rawStr.length-l)+h}}class N{constructor(t){this.prefix=t.startsWith(" ")||t.startsWith("　")?"　":"";const e=String(t).replace(/\uff0c/g,",").replace(/\s+/g,""),l=j(new E(e).format());if(l.length>0){this.address=l.replaceAll(",",", "),this.name=H(e);return}if(this.address="",e.indexOf("→")!=-1){this.name=e.replace(/→/,"　→");return}this.name=e}getFormattedLine(){const t=this.prefix+new E(this.name).formatChildEntry();return this.address.length>0?t+"　　"+this.address:t}}const W=T("<h2 data-v-f1f3bc8e>ゲラから抽出した索引データの整形</h2><ul data-v-f1f3bc8e><li data-v-f1f3bc8e><strong data-v-f1f3bc8e>ゲラからテキストを抽出すると長い行が折り返されて改行になっていることがあります。</strong><ul data-v-f1f3bc8e><li data-v-f1f3bc8e>そうした箇所は先に手動で整形してください。</li></ul></li><li data-v-f1f3bc8e>見よ項目の矢印の前のアキを1倍モノに統一します。</li><li data-v-f1f3bc8e>連続するノンブルを示すダーシの種類を<code data-v-f1f3bc8e>–</code>（enダーシ）に統一します。</li><li data-v-f1f3bc8e>子項目のダーシの種類を<code data-v-f1f3bc8e>――</code>（2倍ダーシ）に統一します。</li></ul>",2),I={key:0},D={class:"detail"},q={class:"original"},z={class:"formatted"},G={__name:"FormatOld",setup(f){const t=n=>n.map(s=>String(s).trimEnd().replace(/\t/,"　　")).map(s=>({formatted:new N(s).getFormattedLine(),original:s})),e=k(""),l=i(()=>L(e.value)),h=i(()=>t(l.value)),_=i(()=>h.value.map(n=>n.formatted).join(`
`)),u=i(()=>h.value.filter(n=>n.formatted!=n.original)),r=i(()=>e.value.length<1?"":u.value.length>0?u.value.length+"箇所を修正しました！":"問題のある箇所は見当たりませんでした！");return(n,s)=>(m(),p(S,null,[W,o(x,{onUpdateContent:s[0]||(s[0]=c=>e.value=c.target.value)}),o(C,{result:d(_)},null,8,["result"]),a("div",null,[a("h4",null,b(d(r)),1),d(u).length?(m(),p("ol",I,[(m(!0),p(S,null,A(d(u),(c,g)=>(m(),p("li",{key:g},[a("ul",D,[a("li",q,b(c.original),1),a("li",z,b(c.formatted),1)])]))),128))])):B("",!0)])],64))}},J=P(G,[["__scopeId","data-v-f1f3bc8e"]]),K="/sakuin-tool/assets/before-553b588b.png",M="/sakuin-tool/assets/after-cef2c7b2.png",Q=a("h2",null,"子項目の復元",-1),X={__name:"ResolveChild",setup(f){const t=r=>{if(r.length<1)return[];const n=[],s=[];n.push(r[0]),s.push(new w(r[0]).basename);for(let c=1;c<r.length;c++){const g=new w(r[c]),v=g.basename;if(v.startsWith("――")){const y=s.at(-1)+v.substring(2);n.push(y+"　　"+g.address)}else if(v.endsWith("――")){const y=v.substring(0,v.length-2)+s.at(-1);n.push(y+"　　"+g.address)}else n.push(g.rawStr),s.push(v)}return n},e=k(""),l=i(()=>L(e.value)),h=i(()=>l.value.map(r=>r.trim()).filter(r=>r.length)),_=i(()=>t(h.value)),u=i(()=>_.value.join(`
`));return(r,n)=>(m(),p(S,null,[Q,o(F,{beforePath:d(K),afterPath:d(M)},null,8,["beforePath","afterPath"]),o(x,{onUpdateContent:n[0]||(n[0]=s=>e.value=s.target.value)}),o(C,{result:d(u)},null,8,["result"])],64))}},Y="/sakuin-tool/assets/before-e62df1a7.png",Z="/sakuin-tool/assets/after-49f03dfc.png",tt={name:"UngroupedTable",props:{lines:Array,resultStr:String},components:{CopyButton:R}},et={key:0},nt={class:"limit-height"},rt=a("thead",null,[a("tr",null,[a("th",null,"項目"),a("th",null,"ノンブル")])],-1);function st(f,t,e,l,h,_){const u=V("CopyButton");return e.lines.length?(m(),p("div",et,[a("div",nt,[a("table",null,[rt,a("tbody",null,[(m(!0),p(S,null,A(e.lines,(r,n)=>(m(),p("tr",{key:n},[a("td",null,b(r.name),1),a("td",null,b(r.nombre),1)]))),128))])])]),o(u,{copyStr:e.resultStr},null,8,["copyStr"])])):B("",!0)}const at=P(tt,[["render",st]]),ot=a("h2",null,"名開き",-1),lt=a("p",null,"※項目とノンブルが Excel 上で2列に分かれていても大丈夫です。",-1),ut={__name:"Ungroup",setup(f){const t=u=>{const r=[];return u.filter(n=>n.trim()).map(n=>n.replace("	","　　")).forEach(n=>{const s=new w(n);if(s.isReference){r.push({name:s.name,nombre:""});return}new U(s.address).nombres.forEach(c=>{r.push({name:s.name,nombre:c.text})})}),r},e=k(""),l=i(()=>L(e.value)),h=i(()=>t(l.value)),_=i(()=>h.value.map(u=>`${u.name}	${u.nombre}`.trimEnd()).join(`
`));return(u,r)=>(m(),p(S,null,[ot,o(F,{beforePath:d(Y),afterPath:d(Z)},null,8,["beforePath","afterPath"]),lt,o(x,{onUpdateContent:r[0]||(r[0]=n=>e.value=n.target.value)}),o(at,{lines:d(h),resultStr:d(_)},null,8,["lines","resultStr"])],64))}},it={class:"reuse"},ct=a("h1",null,"旧版索引の再利用",-1),_t={__name:"ReuseView",setup(f){return(t,e)=>(m(),p("div",it,[ct,o(J),o($),o(X),o($),o(ut),o($)]))}};export{_t as default};
