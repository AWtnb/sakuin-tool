import{S as B}from"./SectionEnd-9029405c.js";import{U as S}from"./utils-e1f3c5ba.js";import{C as f}from"./CopyButton-d936930c.js";import{P as x}from"./PasteBox-7411fd1f.js";import{_,r as d,o as m,a as p,e as t,F as $,g as b,t as h,b as u,h as k,c as P,f as g}from"./index-f4bdc6de.js";const T={name:"TemplateTable",props:{lines:Array,resultStr:String},components:{CopyButton:f}},C={key:0},E={class:"limit-height"},v=t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1),I=t("td",null,null,-1),F=t("td",null,null,-1);function N(e,n,s,i,c,l){const a=d("CopyButton");return s.lines.length?(m(),p("div",C,[t("div",E,[t("table",null,[v,t("tbody",null,[(m(!0),p($,null,b(s.lines,(o,r)=>(m(),p("tr",{key:r},[t("td",null,h(o.id),1),t("td",null,h(o.pageIdx),1),t("td",null,h(o.page),1),I,F]))),128))])])]),u(a,{copyStr:s.resultStr},null,8,["copyStr"])])):k("",!0)}const V=_(T,[["render",N]]),L="/sakuin-tool/assets/generate-index-28f0eaa2.png",D="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",U={name:"ExcelSetting"},w=P('<summary>TIPS：条件付き書式の設定</summary><img src="'+L+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+D+'">',5),j=[w];function A(e,n,s,i,c,l){return m(),p("details",null,j)}const G=_(U,[["render",A]]),H="/sakuin-tool/assets/newtemplate-67fdefb0.png",W=e=>{const n=[];let s=0;return e.filter(i=>i).forEach(i=>{const[c,l,...a]=i.split("	"),o=S.toHalfWidth(l);if(Number(o)>0){s+=1;for(let r=0;r<Number(o);r++)n.push({id:String(n.length+1),pageIdx:String(s),page:String(c)})}}),n},M={name:"Pickup",data:function(){return{content:"",lines:[]}},components:{CopyButton:f,PasteBox:x,TemplateTable:V,ExcelSetting:G},computed:{contentLines:function(){return this.content.split(/\n/).map(e=>String(e))},resultStr:function(){return["ID	index	ページ	項目	見よ先"].concat(this.lines.map(n=>`${n.id}	${n.pageIdx}	${n.page}		`)).join(`
`)}},methods:{reset:function(){this.lines=[]},executeGenerate:function(){this.reset(),W(this.contentLines).forEach(e=>{this.lines.push(e)})}}},O=t("h2",null,"索引拾いのテンプレート生成",-1),q=t("div",null,[t("img",{src:H,alt:""})],-1),z=t("p",null,[t("code",null,"個数"),g("列は見よ項目がある場合、見よ先項目とのペアで1つとカウントします。")],-1);function J(e,n,s,i,c,l){const a=d("PasteBox"),o=d("TemplateTable"),r=d("ExcelSetting");return m(),p($,null,[O,u(a,{onUpdateContent:n[0]||(n[0]=y=>e.content=y.target.value),onButtonClicked:l.executeGenerate},null,8,["onButtonClicked"]),u(o,{lines:e.lines,resultStr:l.resultStr},null,8,["lines","resultStr"]),q,z,u(r)],64)}const K=_(M,[["render",J]]),Q={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:f}},R={key:0},X={class:"limit-height"},Y=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function Z(e,n,s,i,c,l){const a=d("CopyButton");return s.lines.length?(m(),p("div",R,[t("div",X,[t("table",null,[Y,t("tbody",null,[(m(!0),p($,null,b(s.lines,(o,r)=>(m(),p("tr",{key:r},[t("td",null,h(o.name),1),t("td",null,h(o.nombre),1)]))),128))])])]),u(a,{copyStr:s.resultStr},null,8,["copyStr"])])):k("",!0)}const tt=_(Q,[["render",Z]]),et="/sakuin-tool/assets/preformat-9f6a2373.png",nt=e=>{const n=[];return e.filter(s=>s.trim()).forEach(s=>{const[i,c,l,...a]=s.split("	").map(r=>r.trim()),o=String(S.toHalfWidth(i));String(l).length>0?(n.push({nombre:"",name:`${c}　→${l}`}),n.push({nombre:o,name:`${l}（${c}）`})):String(c).length>0&&n.push({nombre:o,name:c})}),n},ot={name:"Preformat",data:function(){return{content:"",lines:[]}},components:{CopyButton:f,PasteBox:x,FormattedTable:tt},computed:{contentLines:function(){return this.content.split(/\n/).map(e=>String(e))},resultStr:function(){return this.lines.map(e=>`${e.name}	${e.nombre}`).join(`
`)}},methods:{reset:function(){this.lines=[]},executeFormat:function(){this.reset(),nt(this.contentLines).forEach(e=>{this.lines.push(e)})}}},st=t("h2",null,"入力済テンプレートの整形",-1),lt=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),g("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),g("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),rt=t("div",null,[t("img",{src:et,alt:""})],-1);function ct(e,n,s,i,c,l){const a=d("PasteBox"),o=d("FormattedTable");return m(),p($,null,[st,u(a,{onUpdateContent:n[0]||(n[0]=r=>e.content=r.target.value),onButtonClicked:l.executeFormat},null,8,["onButtonClicked"]),lt,u(o,{lines:e.lines,resultStr:l.resultStr},null,8,["lines","resultStr"]),rt],64)}const it=_(ot,[["render",ct]]),at={name:"PrepareView",components:{SectionEnd:B,Pickup:K,Preformat:it}},ut={class:"pickup"},dt=t("h1",null,"事前準備",-1);function mt(e,n,s,i,c,l){const a=d("Pickup"),o=d("SectionEnd"),r=d("Preformat");return m(),p("div",ut,[dt,u(a),u(o),u(r),u(o)])}const gt=_(at,[["render",mt]]);export{gt as default};
