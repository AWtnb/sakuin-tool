import{S as B}from"./SectionEnd-263c354d.js";import{_ as w,o as d,a as p,e as t,F as k,g as P,t as y,b as f,h as V,p as E,d as A,c as U,i as x,j as S,u as m,w as I,v as T,k as R,n as D,l as M,f as $,m as j,r as q,q as K}from"./index-3fc0d982.js";import{C as F,S as L,a as H,t as O}from"./SimpleTextarea-15b8ba8e.js";import{B as z}from"./BeforeAfter-c60e6c39.js";const W="/sakuin-tool/assets/template-image-52f629d1.png";const N=s=>(E("data-v-c9afd60e"),s=s(),A(),s),G={key:0},J={class:"limit-height"},Q=N(()=>t("thead",null,[t("tr",null,[t("th",null,"ID"),t("th",null,"index"),t("th",null,"ページ"),t("th",null,"項目"),t("th",null,"見よ先")])],-1)),X={class:"meta-info"},Y={class:"meta-info"},Z=N(()=>t("td",null,null,-1)),tt=N(()=>t("td",null,null,-1)),et={__name:"TemplateTable",props:{rows:Array,resultStr:String},setup(s){return(h,l)=>s.rows.length?(d(),p("div",G,[t("div",J,[t("table",null,[Q,t("tbody",null,[(d(!0),p(k,null,P(s.rows,(a,c)=>(d(),p("tr",{key:c},[t("td",X,y(a.id),1),t("td",Y,y(a.idx),1),t("td",null,y(a.nombre),1),Z,tt]))),128))])])]),f(F,{copyStr:s.resultStr},null,8,["copyStr"])])):V("",!0)}},nt=w(et,[["__scopeId","data-v-c9afd60e"]]),ot="/sakuin-tool/assets/generate-index-28f0eaa2.png",st="/sakuin-tool/assets/generate-index-rule-29fc1c5a.png",lt={name:"ExcelSetting"},at=U('<summary>TIPS：条件付き書式の設定</summary><img src="'+ot+'"><p><code>index</code>列に条件付き書式で<code>偶数の場合に背景色変更</code>という設定をするとページの変わり目が見やすくなり便利です。</p><ul><li>ルールの種類：<code>数式を使用して、書式設定するセルを決定</code></li><li>数式：<code>=MOD($B1,2)=0</code></li></ul><img src="'+st+'">',5),rt=[at];function ut(s,h,l,a,c,v){return d(),p("details",null,rt)}const ct=w(lt,[["render",ut]]);const it={class:"nombre"},dt={class:"ui"},_t=["onKeyup","tabindex"],mt={__name:"CountRow",props:{maxRow:Number,nombreIdx:Number},emits:["updateCounter"],setup(s,{emit:h}){const l=s,a=1e3,c=x(()=>Number(l.nombreIdx)+1),v=x(()=>Number(l.nombreIdx)+a),_=S(0),r=()=>{h("updateCounter",{nombre:c.value,counter:_.value})},n=i=>{const b=Number(i.target.getAttribute("tabindex"))+1;if(a+l.maxRow<=b)return;const g=document.querySelector(`[tabindex="${b}"]`);g&&(g.focus(),g.select())},e=i=>{const b=Number(i.target.getAttribute("tabindex"))-1;if(b<a)return;const g=document.querySelector(`[tabindex="${b}"]`);g&&(g.focus(),g.select())},o=S(!1);return(i,u)=>(d(),p("tr",{class:D({focused:o.value})},[t("td",it,y(m(c)),1),t("td",dt,[I(t("input",{type:"number",min:"0","onUpdate:modelValue":u[0]||(u[0]=b=>_.value=b),onInput:r,onKeyup:[R(n,["right"]),R(e,["left"])],tabindex:m(v),onFocus:u[1]||(u[1]=b=>o.value=!0),onBlur:u[2]||(u[2]=b=>o.value=!1)},null,40,_t),[[T,_.value]])])],2))}},pt=w(mt,[["__scopeId","data-v-200605d7"]]);const C=s=>(E("data-v-41aec5c1"),s=s(),A(),s),ht=C(()=>t("h2",null,"索引拾いのテンプレート生成",-1)),ft=["src"],bt=C(()=>t("p",null,[$("ゲラ上にマーカーを引いた項目を Excel に記入するためのテンプレートを作ります。"),t("br"),$("先にカウントしておくことで、入力作業に集中することができます。")],-1)),vt=["disabled"],xt=["disabled"],$t={class:"wrapper"},gt=C(()=>t("table",{class:"only-header"},[t("thead",null,[t("tr",null,[t("th",null,"ページ"),$(),t("th",null,"個数")])])],-1)),yt={class:"main-content"},St=C(()=>t("ul",null,[t("li",null,"上下キーでカウントを増減させられます"),t("li",null,"左右キーで入力欄を移動できます"),t("li",null,"見よ項目があれば見よ先項目とのペアで1つとカウントします")],-1)),kt={__name:"Pickup",setup(s){const h=S(1),l=S(250),a=x(()=>{const n=[];for(let e=h.value-1;e<l.value;e++)n.push(e);return n}),c=M(new Map),v=n=>{c.set(n.nombre,n.counter)},_=x(()=>{const n=[];let e=0;return Array.from(c.keys()).filter(o=>c.get(o)>0).forEach((o,i)=>{for(let u=0;u<c.get(o);u++)e+=1,n.push({id:e,idx:i+1,nombre:o})}),n}),r=x(()=>[["ID","index","ページ","項目","見よ先"].join("	")].concat(_.value.map(o=>`${o.id}	${o.idx}	${o.nombre}		`)).join(`
`));return(n,e)=>(d(),p(k,null,[ht,t("p",null,[t("img",{src:m(W)},null,8,ft)]),bt,t("label",null,[$("開始ページ"),I(t("input",{type:"number",min:"1","onUpdate:modelValue":e[0]||(e[0]=o=>h.value=o),disabled:m(_).length},null,8,vt),[[T,h.value]])]),t("label",null,[$("終了ページ"),I(t("input",{type:"number",min:"1","onUpdate:modelValue":e[1]||(e[1]=o=>l.value=o),disabled:m(_).length},null,8,xt),[[T,l.value]])]),t("div",$t,[gt,t("div",yt,[t("table",null,[t("tbody",null,[(d(!0),p(k,null,P(m(a),(o,i)=>(d(),j(pt,{nombreIdx:o,maxRow:l.value,key:i,onUpdateCounter:v},null,8,["nombreIdx","maxRow"]))),128))])])])]),St,f(nt,{rows:m(_),resultStr:m(r)},null,8,["rows","resultStr"]),f(ct)],64))}},wt=w(kt,[["__scopeId","data-v-41aec5c1"]]),It="/sakuin-tool/assets/before-f6e4167d.png",Ct="/sakuin-tool/assets/after-8fa046e6.png",Tt={name:"FormattedTable",props:{lines:Array,resultStr:String},components:{CopyButton:F}},Pt={key:0},Nt={class:"limit-height"},Bt=t("thead",null,[t("tr",null,[t("th",null,"項目"),t("th",null,"ノンブル")])],-1);function Rt(s,h,l,a,c,v){const _=q("CopyButton");return l.lines.length?(d(),p("div",Pt,[t("div",Nt,[t("table",null,[Bt,t("tbody",null,[(d(!0),p(k,null,P(l.lines,(r,n)=>(d(),p("tr",{key:n},[t("td",null,y(r.name),1),t("td",null,y(r.nombre),1)]))),128))])])]),f(_,{copyStr:l.resultStr},null,8,["copyStr"])])):V("",!0)}const Vt=w(Tt,[["render",Rt]]),Et=t("h2",null,"入力済テンプレートの整形",-1),At=t("h3",null,"整形内容",-1),Ft=t("ul",null,[t("li",null,"項目を左列に、ページを右列に配置"),t("li",null,[t("code",null,"見よ先"),$("が入力されている場合： "),t("ul",null,[t("li",null,[t("code",null,"　→"),$("でつないで見よ項目を作成")]),t("li",null,"ノンブルを削除"),t("li",null,"代わりに同じノンブルで見よ先項目を作成")])])],-1),Ut={__name:"Preformat",setup(s){const h=r=>{const n=[];return r.filter(e=>e.trim()).map(e=>e.split("	")).filter(e=>e.length>2).map(e=>e.map(o=>o.trim())).forEach(e=>{const o=O(e[0]),i=e[1],u=e[2];if(!(o.length<1||i.length<1)){if(u.length<1){n.push({nombre:o,name:i});return}n.push({nombre:"",name:`${i}　→${u}`}),n.push({nombre:o,name:`${u}（${i}）`})}}),n},l=S(""),a=S(!0),c=x(()=>{const r=H(l.value);return a.value?r.slice(1):r}),v=x(()=>h(c.value)),_=x(()=>v.value.map(r=>`${r.name}	${r.nombre}`).join(`
`));return(r,n)=>(d(),p(k,null,[Et,f(z,{beforePath:m(It),afterPath:m(Ct)},null,8,["beforePath","afterPath"]),At,Ft,t("label",null,[I(t("input",{type:"checkbox","onUpdate:modelValue":n[0]||(n[0]=e=>a.value=e)},null,512),[[K,a.value]]),$("先頭行をスキップする")]),f(L,{onUpdateContent:n[1]||(n[1]=e=>l.value=e.content)}),f(Vt,{lines:m(v),resultStr:m(_)},null,8,["lines","resultStr"])],64))}},Dt={class:"pickup"},Mt=t("h1",null,"事前準備",-1),Ht={__name:"PrepareView",setup(s){return(h,l)=>(d(),p("div",Dt,[Mt,f(wt),f(B),f(Ut),f(B)]))}};export{Ht as default};
